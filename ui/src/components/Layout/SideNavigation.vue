<template>
  <v-navigation-drawer
    v-model="drawer"
    app
    clipped
    class="primary darken-1 white--text font-weight-bold"
  >
    <v-list nav v-for="item in menu" :key="item.title">
      <v-list-group v-if="item.submenu.length" no-action class="white--text">
        <template v-slot:activator>
          <v-list-item-icon>
            <v-icon class="white--text">{{ item.icon }}</v-icon>
          </v-list-item-icon>

          <v-list-item-content>
            <v-list-item-title
              class="white--text"
              v-bind:class="{ 'text-uppercase': !item.doNotCapitalize }"
              >{{ item.title }}</v-list-item-title
            >
          </v-list-item-content>
        </template>

        <v-list-item
          v-for="subitem in item.submenu"
          :key="subitem.title"
          :to="subitem.action"
          class="text-capitalize"
        >
          <v-list-item-content>
            <v-list-item-title
              class="white--text"
              v-text="subitem.title"
            ></v-list-item-title>
          </v-list-item-content>
        </v-list-item>
      </v-list-group>

      <v-list-item v-else link :to="item.action" active-class="darken-2">
        <v-list-item-icon>
          <v-icon class="white--text">{{ item.icon }}</v-icon>
        </v-list-item-icon>

        <v-list-item-content>
          <v-list-item-title
            class="white--text"
            v-bind:class="{ 'text-uppercase': !item.doNotCapitalize }"
            >{{ item.title }}</v-list-item-title
          >
        </v-list-item-content>
      </v-list-item>
    </v-list>
  </v-navigation-drawer>
</template>

<script>
import { serverBus } from "../../main";

export default {
  created() {
    serverBus.$on("toggleDrawer", drawer => {
      this.drawer = drawer;
    });
  },
  data: function() {
    const config = require("@/config/config.json");
    let submenu = [];

    if (config.samplePractitioner) {
      submenu.push({
        action: { path: "/people/view/" + config.samplePractitioner },
        title: "Sample Practitioner"
      });
    }

    submenu.push({
      action: { name: "search-people" },
      title: "Search people"
    });

    submenu.push({
      action: { name: "add-people" },
      title: "Add people"
    });

    return {
      drawer: true,
      menu: [
        {
          action: { name: "home" },
          icon: "dashboard",
          submenu: [],
          title: "Dashboard"
        },
        {
          action: { name: "people" },
          icon: "people",
          submenu: submenu,
          title: "People"
        },
        {
          action: { name: "mhero" },
          icon: "phone",
          submenu: [
            {
              action: { name: "mhero" },
              title: "Send Message"
            },
            {
              action: { name: "mhero-reports" },
              title: "Run Reports"
            }
          ],
          title: "mHero",
          doNotCapitalize: true
        }
      ]
    };
  }
};
</script>
