(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mhero","report"],{"0e8f":function(t,e,i){"use strict";i("20f6");var s=i("e8f2");e["a"]=Object(s["a"])("flex")},1281:function(t,e,i){t.exports=i.p+"img/mHero.3fb599b1.png"},1681:function(t,e,i){},"2bfd":function(t,e,i){},"2c64":function(t,e,i){},"2fc5":function(t,e,i){"use strict";i.r(e);var s,n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ihris-template",{key:t.$route.path},[t._v(" Loading... ")])},a=[],r=(i("d3b7"),i("a026")),o={name:"fhir-report",props:["report"],data:function(){return{}},created:function(){this.$route.params&&this.$route.params.report?s=this.$route.params.report:this.report&&(s=this.report),this.getTemplate()},methods:{getTemplate:function(){var t=this;fetch("/config/report/"+s).then((function(e){e.json().then((function(e){r["a"].component("ihris-template",{name:"ihris-template",data:function(){return{reportData:e.reportData,dataURL:e.dataURL,terms:{}}},components:{"ihris-report":function(){return Promise.all([i.e("fhir-main~fhir-search~mhero"),i.e("fhir-search")]).then(i.bind(null,"2e2c"))},"ihris-search-term":function(){return Promise.all([i.e("fhir-main~fhir-search~mhero"),i.e("fhir-search")]).then(i.bind(null,"d604"))}},template:e.reportTemplate,methods:{searchData:function(t,e){this.$set(this.terms,t,e)}}}),t.$forceUpdate(),console.log("updated template")})).catch((function(e){console.log(e),r["a"].component("ihris-template",{template:"<div><h1>Error</h1><p>An error occurred trying to load this report</p>.</div>"}),t.$forceUpdate()}))})).catch((function(e){console.log(e),r["a"].component("ihris-template",{template:"<div><h1>Error</h1><p>An error occurred trying to load this report</p>.</div>"}),t.$forceUpdate()}))}},components:{},beforeCreate:function(){r["a"].component("ihris-template",{template:"<div>Loading...</div>"})}},c=o,l=i("2877"),u=Object(l["a"])(c,n,a,!1,null,null,null);e["default"]=u.exports},"3d86":function(t,e,i){},5311:function(t,e,i){"use strict";var s=i("5607"),n=i("a026");e["a"]=n["a"].extend({name:"rippleable",directives:{ripple:s["a"]},props:{ripple:{type:[Boolean,Object],default:!0}},methods:{genRipple:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.ripple?(t.staticClass="v-input--selection-controls__ripple",t.directives=t.directives||[],t.directives.push({name:"ripple",value:{center:!0}}),t.on=Object.assign({click:this.onChange},this.$listeners),this.$createElement("div",t)):null},onChange:function(){}}})},6629:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-stepper",{model:{value:t.stepper,callback:function(e){t.stepper=e},expression:"stepper"}},[i("v-stepper-items",[i("v-stepper-content",{attrs:{step:"1"}},[i("selectRecipients",{on:{mheroRecipientsSelected:t.importData}})],1),i("v-stepper-content",{attrs:{step:"2"}},[i("reviewRecipients",{attrs:{headers:t.headers,practitioners:t.selectedPractitioners},on:{editWorkflow:t.changeWorkflow}})],1)],1)],1)},n=[],a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",[s("v-card",[s("v-img",{attrs:{src:i("1281"),width:"100"}}),s("ihrisReport",{attrs:{report:"mhero"}}),s("v-card-actions",{staticClass:"secondary"},[s("v-spacer"),s("v-btn",{staticStyle:{},attrs:{disabled:!t.canReview,normal:"",rounded:""},on:{click:t.nextStep}},[t._v("Review Selection")])],1)],1)],1)},r=[],o=i("b85c"),c=i("2fc5"),l=i("56d7"),u={data:function(){return{practitioners:[],reportData:{}}},computed:{canReview:function(){return this.practitioners.length>0}},methods:{nextStep:function(){var t,e=[],i=Object(o["a"])(this.reportData.fieldsDetails);try{for(i.s();!(t=i.n()).done;){var s,n=t.value,a=Object(o["a"])(n.fields);try{for(a.s();!(s=a.n()).done;){var r=s.value;e.push({text:r[0],value:r[1]})}}catch(c){a.e(c)}finally{a.f()}}}catch(c){i.e(c)}finally{i.f()}this.$emit("mheroRecipientsSelected",this.practitioners,e)}},components:{ihrisReport:c["default"]},created:function(){var t=this;l["eventBus"].$on("ihris-report-selections",(function(e,i){t.practitioners=e,t.reportData=i}))}},h=u,p=i("2877"),d=i("6544"),f=i.n(d),v=i("8336"),m=i("b0af"),b=i("99d9"),g=i("a523"),S=i("adda"),y=i("2fa4"),D=Object(p["a"])(h,a,r,!1,null,null,null),I=D.exports;f()(D,{VBtn:v["a"],VCard:m["a"],VCardActions:b["a"],VContainer:g["a"],VImg:S["a"],VSpacer:y["a"]});var w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",[s("v-dialog",{attrs:{persistent:"","max-width":"300"},model:{value:t.statusDialog.enable,callback:function(e){t.$set(t.statusDialog,"enable",e)},expression:"statusDialog.enable"}},[s("v-card",[s("v-toolbar",{attrs:{color:t.statusDialog.color,dark:""}},[s("v-toolbar-title",[s("v-icon",{domProps:{textContent:t._s(t.statusDialog.icon)}}),t._v(" "+t._s(t.statusDialog.title)+" ")],1),s("v-spacer"),s("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(e){t.statusDialog.enable=!1}}},[s("v-icon",[t._v("mdi-close")])],1)],1),s("v-card-text",[s("b",[t._v(t._s(t.statusDialog.description))])]),s("v-card-actions",[s("v-spacer"),s("v-btn",{staticClass:"white--font",attrs:{dark:"",color:"primary"},on:{click:function(e){t.statusDialog.enable=!1}}},[t._v("Ok")])],1)],1)],1),s("v-img",{attrs:{src:i("1281"),width:"100"}}),s("v-card",[s("v-card-text",[t._v(" How do you want to send Message "),s("v-radio-group",{model:{value:t.communicationType,callback:function(e){t.communicationType=e},expression:"communicationType"}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs2:""}},[s("v-radio",{attrs:{label:"Workflow",value:"flow"}})],1),s("v-flex",{attrs:{xs2:""}},[s("v-radio",{attrs:{label:"Ad-hoc Message",value:"sms"}})],1)],1)],1),"flow"==t.communicationType?s("v-autocomplete",{attrs:{"background-color":"grey lighten-2",label:"Select flow from RapidPro",items:t.workflows,"return-object":""},model:{value:t.workflow,callback:function(e){t.workflow=e},expression:"workflow"}}):t._e(),"sms"==t.communicationType?s("v-textarea",{attrs:{"background-color":"grey lighten-2",color:"blue",label:"Text Message"},model:{value:t.sms,callback:function(e){t.sms=e},expression:"sms"}}):t._e()],1)],1),s("br"),s("v-card",[s("v-card-title",[t._v(" Recipients ")]),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.practitioners,"item-key":"id"}}),s("v-card-actions",{staticClass:"secondary"},[s("v-btn",{attrs:{normal:"",rounded:""},on:{click:t.changeDetails}},[t._v("Edit Recipients")]),s("v-spacer"),s("v-btn",{attrs:{disabled:!t.canSend,normal:"",rounded:""},on:{click:t.send}},[t._v("Send "),s("v-icon",[t._v("mdi-message")])],1)],1)],1)],1)},x=[],k=(i("a4d3"),i("e01a"),i("4160"),i("d3b7"),i("159b"),{props:["headers","practitioners"],data:function(){return{workflows:[],workflow:{},communicationType:"",sms:"",statusDialog:{width:"500px",enable:!1,color:"error",icon:"mdi-alert-circle-outline",title:"",description:""}}},methods:{changeDetails:function(){this.$emit("editWorkflow")},send:function(){var t=this,e=[];this.practitioners.forEach((function(t){e.push(t.id)}));var i={practitioners:e,workflow:this.workflow.id};"sms"===this.communicationType?(i.sms=this.sms,i.workflow=null):"flow"===this.communicationType&&(i.workflow=this.workflow.id,i.sms=null),i=JSON.stringify(i);var s="/mhero/send-message",n={method:"POST",headers:{"Content-Type":"application/json"},body:i,redirect:"manual"};fetch(s,n).then((function(){t.statusDialog.enable=!0,t.statusDialog.color="success",t.statusDialog.title="Success","sms"===t.communicationType?t.statusDialog.description="Message Sent Successfully":t.statusDialog.description="Workflow Started Successfully"})).catch((function(e){t.statusDialog.enable=!0,t.statusDialog.color="error",t.statusDialog.title="Error","sms"===t.communicationType?t.statusDialog.description="Failed to send Message":t.statusDialog.description="Failed to start a workflow",console.log(e)}))}},computed:{canSend:function(){return!!this.communicationType&&(!("sms"==this.communicationType&&!this.sms)&&!("flow"===this.communicationType&&!this.workflow.id))}},created:function(){var t=this;fetch("/mhero/workflows").then((function(e){e.json().then((function(e){t.workflows=e}))}))}}),C=k,V=i("c6a6"),_=i("8fea"),O=i("169a"),$=i("0e8f"),T=i("132d"),j=(i("20f6"),i("e8f2")),G=Object(j["a"])("layout"),A=(i("b0c0"),i("5530")),R=(i("2c64"),i("ba87")),F=i("9d26"),P=i("c37a"),E=i("7e2b"),B=i("a9ad"),L=i("4e82"),U=i("5311"),M=i("7560"),N=i("fe09"),H=i("80d2"),z=i("58df"),K=Object(z["a"])(E["a"],B["a"],U["a"],Object(L["a"])("radioGroup"),M["a"]),W=K.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:function(){return{isFocused:!1}},computed:{classes:function(){return Object(A["a"])(Object(A["a"])({"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused},this.themeClasses),this.groupClasses)},computedColor:function(){return N["a"].options.computed.computedColor.call(this)},computedIcon:function(){return this.isActive?this.onIcon:this.offIcon},computedId:function(){return P["a"].options.computed.computedId.call(this)},hasLabel:P["a"].options.computed.hasLabel,hasState:function(){return(this.radioGroup||{}).hasState},isDisabled:function(){return this.disabled||!!(this.radioGroup||{}).disabled},isReadonly:function(){return this.readonly||!!(this.radioGroup||{}).readonly},computedName:function(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||"radio-".concat(this.radioGroup._uid)},rippleState:function(){return N["a"].options.computed.rippleState.call(this)},validationState:function(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput:function(t){return N["a"].options.methods.genInput.call(this,"radio",t)},genLabel:function(){var t=this;return this.hasLabel?this.$createElement(R["a"],{on:{click:function(e){e.preventDefault(),t.onChange()}},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},Object(H["r"])(this,"label")||this.label):null},genRadio:function(){return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(F["a"],this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput(Object(A["a"])({name:this.computedName,value:this.value},this.attrs$)),this.genRipple(this.setTextColor(this.rippleState))])},onFocus:function(t){this.isFocused=!0,this.$emit("focus",t)},onBlur:function(t){this.isFocused=!1,this.$emit("blur",t)},onChange:function(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:function(){}},render:function(t){var e={staticClass:"v-radio",class:this.classes};return t("div",e,[this.genRadio(),this.genLabel()])}}),J=(i("a9e3"),i("ec29"),i("3d86"),i("604c")),q=i("8547"),Y=Object(z["a"])(q["a"],J["a"],P["a"]),Q=Y.extend({name:"v-radio-group",provide:function(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes:function(){return Object(A["a"])(Object(A["a"])({},P["a"].options.computed.classes.call(this)),{},{"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row})}},methods:{genDefaultSlot:function(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},P["a"].options.methods.genDefaultSlot.call(this))},genInputSlot:function(){var t=P["a"].options.methods.genInputSlot.call(this);return delete t.data.on.click,t},genLabel:function(){var t=P["a"].options.methods.genLabel.call(this);return t?(t.data.attrs.id=this.computedId,delete t.data.attrs.for,t.tag="legend",t):null},onClick:J["a"].options.methods.onClick}}),X=i("a844"),Z=i("71d9"),tt=i("2a7f"),et=Object(p["a"])(C,w,x,!1,null,null,null),it=et.exports;f()(et,{VAutocomplete:V["a"],VBtn:v["a"],VCard:m["a"],VCardActions:b["a"],VCardText:b["c"],VCardTitle:b["d"],VContainer:g["a"],VDataTable:_["a"],VDialog:O["a"],VFlex:$["a"],VIcon:T["a"],VImg:S["a"],VLayout:G,VRadio:W,VRadioGroup:Q,VSpacer:y["a"],VTextarea:X["a"],VToolbar:Z["a"],VToolbarTitle:tt["a"]});var st={components:{selectRecipients:I,reviewRecipients:it},data:function(){return{headers:[],selectedPractitioners:[],stepper:1}},methods:{changeWorkflow:function(){this.stepper=1},importData:function(t,e){this.selectedPractitioners=t,this.headers=e,this.stepper=2}}},nt=st,at=(i("4de4"),i("8836"),i("3206")),rt=i("a452"),ot=i("d9bd"),ct=Object(z["a"])(Object(at["b"])("stepper"),rt["a"],M["a"]),lt=ct.extend({name:"v-stepper",provide:function(){return{stepClick:this.stepClick,isVertical:this.vertical}},props:{altLabels:Boolean,nonLinear:Boolean,vertical:Boolean},data:function(){var t={isBooted:!1,steps:[],content:[],isReverse:!1};return t.internalLazyValue=null!=this.value?this.value:(t[0]||{}).step||1,t},computed:{classes:function(){return Object(A["a"])({"v-stepper--is-booted":this.isBooted,"v-stepper--vertical":this.vertical,"v-stepper--alt-labels":this.altLabels,"v-stepper--non-linear":this.nonLinear},this.themeClasses)}},watch:{internalValue:function(t,e){this.isReverse=Number(t)<Number(e),e&&(this.isBooted=!0),this.updateView()}},created:function(){this.$listeners.input&&Object(ot["a"])("@input","@change",this)},mounted:function(){this.updateView()},methods:{register:function(t){"v-stepper-step"===t.$options.name?this.steps.push(t):"v-stepper-content"===t.$options.name&&(t.isVertical=this.vertical,this.content.push(t))},unregister:function(t){"v-stepper-step"===t.$options.name?this.steps=this.steps.filter((function(e){return e!==t})):"v-stepper-content"===t.$options.name&&(t.isVertical=this.vertical,this.content=this.content.filter((function(e){return e!==t})))},stepClick:function(t){var e=this;this.$nextTick((function(){return e.internalValue=t}))},updateView:function(){for(var t=this.steps.length;--t>=0;)this.steps[t].toggle(this.internalValue);for(var e=this.content.length;--e>=0;)this.content[e].toggle(this.internalValue,this.isReverse)}},render:function(t){return t("div",{staticClass:"v-stepper",class:this.classes},this.$slots.default)}}),ut=(i("25f0"),i("0789")),ht=Object(z["a"])(Object(at["a"])("stepper","v-stepper-content","v-stepper")),pt=ht.extend().extend({name:"v-stepper-content",inject:{isVerticalProvided:{from:"isVertical"}},props:{step:{type:[Number,String],required:!0}},data:function(){return{height:0,isActive:null,isReverse:!1,isVertical:this.isVerticalProvided}},computed:{computedTransition:function(){var t=this.$vuetify.rtl?!this.isReverse:this.isReverse;return t?ut["f"]:ut["g"]},styles:function(){return this.isVertical?{height:Object(H["g"])(this.height)}:{}}},watch:{isActive:function(t,e){t&&null==e?this.height="auto":this.isVertical&&(this.isActive?this.enter():this.leave())}},mounted:function(){this.$refs.wrapper.addEventListener("transitionend",this.onTransition,!1),this.stepper&&this.stepper.register(this)},beforeDestroy:function(){this.$refs.wrapper.removeEventListener("transitionend",this.onTransition,!1),this.stepper&&this.stepper.unregister(this)},methods:{onTransition:function(t){this.isActive&&"height"===t.propertyName&&(this.height="auto")},enter:function(){var t=this,e=0;requestAnimationFrame((function(){e=t.$refs.wrapper.scrollHeight})),this.height=0,setTimeout((function(){return t.isActive&&(t.height=e||"auto")}),450)},leave:function(){var t=this;this.height=this.$refs.wrapper.clientHeight,setTimeout((function(){return t.height=0}),10)},toggle:function(t,e){this.isActive=t.toString()===this.step.toString(),this.isReverse=e}},render:function(t){var e={staticClass:"v-stepper__content"},i={staticClass:"v-stepper__wrapper",style:this.styles,ref:"wrapper"};this.isVertical||(e.directives=[{name:"show",value:this.isActive}]);var s=t("div",i,[this.$slots.default]),n=t("div",e,[s]);return t(this.computedTransition,{on:this.$listeners},[n])}}),dt=(i("45fc"),i("5607")),ft=Object(z["a"])(B["a"],Object(at["a"])("stepper","v-stepper-step","v-stepper")),vt=(ft.extend().extend({name:"v-stepper-step",directives:{ripple:dt["a"]},inject:["stepClick"],props:{color:{type:String,default:"primary"},complete:Boolean,completeIcon:{type:String,default:"$complete"},editable:Boolean,editIcon:{type:String,default:"$edit"},errorIcon:{type:String,default:"$error"},rules:{type:Array,default:function(){return[]}},step:[Number,String]},data:function(){return{isActive:!1,isInactive:!0}},computed:{classes:function(){return{"v-stepper__step--active":this.isActive,"v-stepper__step--editable":this.editable,"v-stepper__step--inactive":this.isInactive,"v-stepper__step--error error--text":this.hasError,"v-stepper__step--complete":this.complete}},hasError:function(){return this.rules.some((function(t){return!0!==t()}))}},mounted:function(){this.stepper&&this.stepper.register(this)},beforeDestroy:function(){this.stepper&&this.stepper.unregister(this)},methods:{click:function(t){t.stopPropagation(),this.$emit("click",t),this.editable&&this.stepClick(this.step)},genIcon:function(t){return this.$createElement(F["a"],t)},genLabel:function(){return this.$createElement("div",{staticClass:"v-stepper__label"},this.$slots.default)},genStep:function(){var t=!(this.hasError||!this.complete&&!this.isActive)&&this.color;return this.$createElement("span",this.setBackgroundColor(t,{staticClass:"v-stepper__step__step"}),this.genStepContent())},genStepContent:function(){var t=[];return this.hasError?t.push(this.genIcon(this.errorIcon)):this.complete?this.editable?t.push(this.genIcon(this.editIcon)):t.push(this.genIcon(this.completeIcon)):t.push(String(this.step)),t},toggle:function(t){this.isActive=t.toString()===this.step.toString(),this.isInactive=Number(t)<Number(this.step)}},render:function(t){return t("div",{staticClass:"v-stepper__step",class:this.classes,directives:[{name:"ripple",value:this.editable}],on:{click:this.click}},[this.genStep(),this.genLabel()])}}),Object(H["i"])("v-stepper__header"),Object(H["i"])("v-stepper__items")),mt=Object(p["a"])(nt,s,n,!1,null,null,null);e["default"]=mt.exports;f()(mt,{VStepper:lt,VStepperContent:pt,VStepperItems:vt})},"7dda":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",[s("v-dialog",{attrs:{persistent:"","max-width":"330"},model:{value:t.statusDialog.enable,callback:function(e){t.$set(t.statusDialog,"enable",e)},expression:"statusDialog.enable"}},[s("v-card",[s("v-toolbar",{attrs:{color:t.statusDialog.color,dark:""}},[s("v-toolbar-title",[s("v-icon",{domProps:{textContent:t._s(t.statusDialog.icon)}}),t._v(" "+t._s(t.statusDialog.title)+" ")],1),s("v-spacer"),s("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(e){t.statusDialog.enable=!1}}},[s("v-icon",[t._v("mdi-close")])],1)],1),s("v-card-text",[s("b",[t._v(t._s(t.statusDialog.description))])]),s("v-card-actions",[s("v-spacer"),s("v-btn",{staticClass:"white--font",attrs:{dark:"",color:"primary"},on:{click:function(e){t.statusDialog.enable=!1}}},[t._v("Ok")])],1)],1)],1),t.unSubscribeDialog?s("v-dialog",{attrs:{persistent:"",width:"850px"},model:{value:t.unSubscribeDialog,callback:function(e){t.unSubscribeDialog=e},expression:"unSubscribeDialog"}},[s("v-card",[s("v-toolbar",{attrs:{color:"primary darken-1 white--text",height:"30",dark:""}},[t._v(" UnSubscribe From Groups "),s("v-spacer"),s("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(e){t.unSubscribeDialog=!1}}},[s("v-icon",[t._v("mdi-close")])],1)],1),s("v-card-text",[t._v(" Select Groups To Unsubscribe "),s("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{headers:t.groupHeaders,items:t.unsubscribingGroups,options:t.tblOptions,"server-items-length":t.totalUnsubGroups,"footer-props":{"items-per-page-options":[5,10,20,50]},loading:t.loadingUnsubGrps,"show-select":""},on:{"update:options":function(e){t.tblOptions=e}},model:{value:t.selectedUnsubGrps,callback:function(e){t.selectedUnsubGrps=e},expression:"selectedUnsubGrps"}})],1),s("v-card-actions",[s("v-spacer"),s("v-flex",{attrs:{xs2:""}},[s("v-btn",{staticClass:"white--text",attrs:{disabled:!t.unsubGroupSelected,color:"green",small:""},on:{click:t.saveUnSubscribe}},[s("v-icon",{attrs:{left:""}},[t._v(" mdi-plus ")]),t._v("Unsubscribe ")],1)],1)],1)],1),s("v-card",[s("v-card-title",[t._v(" Subscribed Members ")]),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.subscribingPractitioners,"item-key":"id"}})],1)],1):t._e(),t.subscribeDialog?s("v-dialog",{attrs:{persistent:"",width:"850px"},model:{value:t.subscribeDialog,callback:function(e){t.subscribeDialog=e},expression:"subscribeDialog"}},[s("v-card",[s("v-toolbar",{attrs:{color:"primary darken-1 white--text",height:"30",dark:""}},[t._v(" Subscribe To Groups "),s("v-spacer"),s("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(e){t.subscribeDialog=!1}}},[s("v-icon",[t._v("mdi-close")])],1)],1),s("v-card-text",[s("ihrisReport",{attrs:{report:"groups"}})],1),s("v-card-actions",[s("v-spacer"),s("v-flex",{attrs:{xs2:""}},[s("v-btn",{staticClass:"white--text",attrs:{disabled:!t.groupSelected,color:"green"},on:{click:t.saveSubscription}},[s("v-icon",{attrs:{left:""}},[t._v(" mdi-plus ")]),t._v("Save ")],1)],1)],1)],1),s("v-card",[s("v-card-title",[t._v(" Subscribing Members ")]),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.subscribingPractitioners,"item-key":"id"}})],1)],1):t._e(),s("v-card",[s("v-img",{attrs:{src:i("1281"),width:"100"}}),s("ihrisReport",{attrs:{report:"contact-groups"}}),s("v-card-actions",{staticClass:"secondary"},[s("v-btn",{staticStyle:{},attrs:{color:"error",disabled:!t.practitionerSelected,normal:"",rounded:""},on:{click:t.unsubscribe}},[t._v(" UnSubscribe ")]),s("v-spacer"),s("v-btn",{staticStyle:{},attrs:{color:"primary",disabled:!t.practitionerSelected,normal:"",rounded:""},on:{click:t.subscribe}},[t._v(" Subscribe ")])],1)],1)],1)},n=[],a=(i("a4d3"),i("e01a"),i("7db0"),i("4160"),i("c975"),i("b0c0"),i("d3b7"),i("9911"),i("159b"),i("b85c")),r=i("2fc5"),o=i("56d7"),c={data:function(){return{subscribingPractitioners:[],subscribingGroups:[],unsubscribingGroups:[],selectedUnsubGrps:[],totalUnsubGroups:0,reportData:{},subscribeDialog:!1,unSubscribeDialog:!1,loadingUnsubGrps:!1,groupHeaders:[{text:"Name",value:"name"}],tblOptions:{itemsPerPage:1},prevPage:-1,link:[],statusDialog:{width:"500px",enable:!1,color:"error",icon:"mdi-alert-circle-outline",title:"",description:""}}},computed:{practitionerSelected:function(){return this.subscribingPractitioners.length>0},groupSelected:function(){return this.subscribingGroups.length>0},unsubGroupSelected:function(){return this.selectedUnsubGrps.length>0},headers:function(){var t,e=[],i=Object(a["a"])(this.reportData.fieldsDetails);try{for(i.s();!(t=i.n()).done;){var s,n=t.value,r=Object(a["a"])(n.fields);try{for(r.s();!(s=r.n()).done;){var o=s.value;e.push({text:o[0],value:o[1]})}}catch(c){r.e(c)}finally{r.f()}}}catch(c){i.e(c)}finally{i.f()}return e}},watch:{tblOptions:{handler:function(){this.getMembersGroups()},deep:!0}},methods:{getFullEntityIDs:function(t){var e=this,i=[];return t.forEach((function(t){for(var s,n=["Practitioner","Patient","Person"],a=0,r=n;a<r.length;a++){var o=r[a];if(t[o+".id"]){s=t[o+".id"];break}}s||(s=e.reportData.primaryResource+"/"+t.id),i.push(s)})),i},subscribe:function(){this.subscribeDialog=!0,this.subscribingGroups=[]},unsubscribe:function(){this.selectedUnsubGrps=[],this.unsubscribingGroups=[],this.loadingUnsubGrps=!0;var t,e="/fhir/Group?_elements=name,id&member=",i="",s=this.getFullEntityIDs(this.subscribingPractitioners),n=Object(a["a"])(s);try{for(n.s();!(t=n.n()).done;){var r=t.value;i+=i?","+r:r}}catch(o){n.e(o)}finally{n.f()}e+=i+"&_count=1&_total=accurate",this.getMembersGroups(e,!0)},getMembersGroups:function(t,e){var i=this;e&&(this.tblOptions.page=1),this.tblOptions.page>1&&(this.tblOptions.page===this.prevPage-1?t=this.link.find((function(t){return"previous"===t.relation})).url:this.tblOptions.page===this.prevPage+1&&(t=this.link.find((function(t){return"next"===t.relation})).url),t=t.substring(t.indexOf("/fhir/"))),this.prevPage=this.tblOptions.page,fetch(t).then((function(t){t.json().then((function(t){if(t.total>0){i.link=t.link,i.totalUnsubGroups=t.total;var e,s=Object(a["a"])(t.entry);try{for(s.s();!(e=s.n()).done;){var n=e.value;i.unsubscribingGroups.push({name:n.resource.name,id:n.resource.id})}}catch(r){s.e(r)}finally{s.f()}}i.loadingUnsubGrps=!1,i.unSubscribeDialog=!0}))})).catch((function(t){i.loadingUnsubGrps=!1,i.statusDialog.enable=!0,i.statusDialog.color="error",i.statusDialog.title="Error",i.statusDialog.description="An error has occured",console.log(t)}))},saveUnSubscribe:function(){var t=this,e=this.getFullEntityIDs(this.subscribingPractitioners),i=[];this.selectedUnsubGrps.forEach((function(t){i.push(t.id)}));var s={members:e,groups:i};s=JSON.stringify(s);var n="/mhero/unsubscribe-contact-groups",a={method:"POST",headers:{"Content-Type":"application/json"},body:s,redirect:"manual"};fetch(n,a).then((function(){t.unSubscribeDialog=!1,t.statusDialog.enable=!0,t.statusDialog.color="success",t.statusDialog.title="Success",t.statusDialog.description="Contacts UnSubscribed successfully",o["eventBus"].$emit("reload-report")})).catch((function(e){t.unSubscribeDialog=!1,t.statusDialog.enable=!0,t.statusDialog.color="error",t.statusDialog.title="Error",t.statusDialog.description="Failed to UnSubscribe contacts",console.log(e)}))},saveSubscription:function(){var t=this,e=this.getFullEntityIDs(this.subscribingPractitioners),i=[];this.subscribingGroups.forEach((function(t){i.push(t.id)}));var s={members:e,groups:i};s=JSON.stringify(s);var n="/mhero/subscribe-contact-groups",a={method:"POST",headers:{"Content-Type":"application/json"},body:s,redirect:"manual"};fetch(n,a).then((function(){t.subscribeDialog=!1,t.statusDialog.enable=!0,t.statusDialog.color="success",t.statusDialog.title="Success",t.statusDialog.description="Contacts subscribed successfully",o["eventBus"].$emit("reload-report")})).catch((function(e){t.subscribeDialog=!1,t.statusDialog.enable=!0,t.statusDialog.color="error",t.statusDialog.title="Error",t.statusDialog.description="Failed to subscribe contacts",console.log(e)}))}},components:{ihrisReport:r["default"]},created:function(){var t=this;o["eventBus"].$on("ihris-report-selections",(function(e,i){"Group"===i.primaryResource?t.subscribingGroups=e:(t.subscribingPractitioners=e,t.reportData=i)}))}},l=c,u=i("2877"),h=i("6544"),p=i.n(h),d=i("8336"),f=i("b0af"),v=i("99d9"),m=i("a523"),b=i("8fea"),g=i("169a"),S=i("0e8f"),y=i("132d"),D=i("adda"),I=i("2fa4"),w=i("71d9"),x=i("2a7f"),k=Object(u["a"])(l,s,n,!1,null,null,null);e["default"]=k.exports;p()(k,{VBtn:d["a"],VCard:f["a"],VCardActions:v["a"],VCardText:v["c"],VCardTitle:v["d"],VContainer:m["a"],VDataTable:b["a"],VDialog:g["a"],VFlex:S["a"],VIcon:y["a"],VImg:D["a"],VSpacer:I["a"],VToolbar:w["a"],VToolbarTitle:x["a"]})},8836:function(t,e,i){},a844:function(t,e,i){"use strict";i("a9e3");var s=i("5530"),n=(i("1681"),i("8654")),a=i("58df"),r=Object(a["a"])(n["a"]);e["a"]=r.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(t){return!isNaN(parseFloat(t))}},rows:{type:[Number,String],default:5,validator:function(t){return!isNaN(parseInt(t,10))}}},computed:{classes:function(){return Object(s["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},n["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var t=this;setTimeout((function(){t.autoGrow&&t.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var t=this.$refs.input;if(t){t.style.height="0";var e=t.scrollHeight,i=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(i,e)+"px"}},genInput:function(){var t=n["a"].options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput:function(t){n["a"].options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}})},c6a6:function(t,e,i){"use strict";i("4de4"),i("7db0"),i("c975"),i("d81d"),i("45fc"),i("498a");var s=i("5530"),n=(i("2bfd"),i("b974")),a=i("8654"),r=i("d9f7"),o=i("80d2"),c=Object(s["a"])(Object(s["a"])({},n["b"]),{},{offsetY:!0,offsetOverflow:!0,transition:!1});e["a"]=n["a"].extend({name:"v-autocomplete",props:{allowOverflow:{type:Boolean,default:!0},autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:function(t,e,i){return i.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1}},hideNoData:Boolean,menuProps:{type:n["a"].options.props.menuProps.type,default:function(){return c}},noFilter:Boolean,searchInput:{type:String,default:void 0}},data:function(){return{lazySearch:this.searchInput}},computed:{classes:function(){return Object(s["a"])(Object(s["a"])({},n["a"].options.computed.classes.call(this)),{},{"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1})},computedItems:function(){return this.filteredItems},selectedValues:function(){var t=this;return this.selectedItems.map((function(e){return t.getValue(e)}))},hasDisplayedItems:function(){var t=this;return this.hideSelected?this.filteredItems.some((function(e){return!t.hasItem(e)})):this.filteredItems.length>0},currentRange:function(){return null==this.selectedItem?0:String(this.getText(this.selectedItem)).length},filteredItems:function(){var t=this;return!this.isSearching||this.noFilter||null==this.internalSearch?this.allItems:this.allItems.filter((function(e){var i=Object(o["q"])(e,t.itemText,void 0),s=null!=i?String(i):"";return t.filter(e,String(t.internalSearch),s)}))},internalSearch:{get:function(){return this.lazySearch},set:function(t){this.lazySearch=t,this.$emit("update:search-input",t)}},isAnyValueAllowed:function(){return!1},isDirty:function(){return this.searchIsDirty||this.selectedItems.length>0},isSearching:function(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow:function(){return!!this.isFocused&&(this.hasDisplayedItems||!this.hideNoData)},$_menuProps:function(){var t=n["a"].options.computed.$_menuProps.call(this);return t.contentClass="v-autocomplete__content ".concat(t.contentClass||"").trim(),Object(s["a"])(Object(s["a"])({},c),t)},searchIsDirty:function(){return null!=this.internalSearch&&""!==this.internalSearch},selectedItem:function(){var t=this;return this.multiple?null:this.selectedItems.find((function(e){return t.valueComparator(t.getValue(e),t.getValue(t.internalValue))}))},listData:function(){var t=n["a"].options.computed.listData.call(this);return t.props=Object(s["a"])(Object(s["a"])({},t.props),{},{items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch}),t}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused:function(t){t?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.updateSelf())},isMenuActive:function(t){!t&&this.hasSlot&&(this.lazySearch=void 0)},items:function(t,e){e&&e.length||!this.hideNoData||!this.isFocused||this.isMenuActive||!t.length||this.activateMenu()},searchInput:function(t){this.lazySearch=t},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created:function(){this.setSearch()},methods:{onFilteredItemsChanged:function(t,e){var i=this;t!==e&&(this.setMenuIndex(-1),this.$nextTick((function(){i.internalSearch&&(1===t.length||i.autoSelectFirst)&&(i.$refs.menu.getTiles(),i.setMenuIndex(0))})))},onInternalSearchChanged:function(){this.updateMenuDimensions()},updateMenuDimensions:function(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex:function(t){this.searchIsDirty||(this.multiple&&t===o["w"].left?-1===this.selectedIndex?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&t===o["w"].right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:t!==o["w"].backspace&&t!==o["w"].delete||this.deleteCurrentItem())},deleteCurrentItem:function(){if(!this.readonly){var t=this.selectedItems.length-1;if(-1!==this.selectedIndex||0===t){var e=this.selectedItems[this.selectedIndex];if(!this.getDisabled(e)){var i=this.selectedIndex===t?this.selectedIndex-1:this.selectedItems[this.selectedIndex+1]?this.selectedIndex:-1;-1===i?this.setValue(this.multiple?[]:void 0):this.selectItem(e),this.selectedIndex=i}}else this.selectedIndex=t}},clearableCallback:function(){this.internalSearch=void 0,n["a"].options.methods.clearableCallback.call(this)},genInput:function(){var t=a["a"].options.methods.genInput.call(this);return t.data=Object(r["a"])(t.data,{attrs:{"aria-activedescendant":Object(o["o"])(this.$refs.menu,"activeTile.id"),autocomplete:Object(o["o"])(t.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),t},genInputSlot:function(){var t=n["a"].options.methods.genInputSlot.call(this);return t.data.attrs.role="combobox",t},genSelections:function(){return this.hasSlot||this.multiple?n["a"].options.methods.genSelections.call(this):[]},onClick:function(t){this.isDisabled||(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(t.target)||this.activateMenu())},onInput:function(t){if(!(this.selectedIndex>-1)&&t.target){var e=t.target,i=e.value;e.value&&this.activateMenu(),this.internalSearch=i,this.badInput=e.validity&&e.validity.badInput}},onKeyDown:function(t){var e=t.keyCode;n["a"].options.methods.onKeyDown.call(this,t),this.changeSelectedIndex(e)},onSpaceDown:function(t){},onTabDown:function(t){n["a"].options.methods.onTabDown.call(this,t),this.updateSelf()},onUpDown:function(t){t.preventDefault(),this.activateMenu()},selectItem:function(t){n["a"].options.methods.selectItem.call(this,t),this.setSearch()},setSelectedItems:function(){n["a"].options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch:function(){var t=this;this.$nextTick((function(){t.multiple&&t.internalSearch&&t.isMenuActive||(t.internalSearch=!t.selectedItems.length||t.multiple||t.hasSlot?null:t.getText(t.selectedItem))}))},updateSelf:function(){(this.searchIsDirty||this.internalValue)&&(this.valueComparator(this.internalSearch,this.getValue(this.internalValue))||this.setSearch())},hasItem:function(t){return this.selectedValues.indexOf(this.getValue(t))>-1},onCopy:function(t){if(-1!==this.selectedIndex){var e=this.selectedItems[this.selectedIndex],i=this.getText(e);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/vnd.vuetify.autocomplete.item+plain",i),t.preventDefault()}}}})},ec29:function(t,e,i){},fe09:function(t,e,i){"use strict";i("4de4"),i("45fc"),i("d3b7"),i("25f0");var s=i("c37a"),n=i("5311"),a=i("8547"),r=i("58df");e["a"]=Object(r["a"])(s["a"],n["a"],a["a"]).extend({name:"selectable",model:{prop:"inputValue",event:"change"},props:{id:String,inputValue:null,falseValue:null,trueValue:null,multiple:{type:Boolean,default:null},label:String},data:function(){return{hasColor:this.inputValue,lazyValue:this.inputValue}},computed:{computedColor:function(){if(this.isActive)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},isMultiple:function(){return!0===this.multiple||null===this.multiple&&Array.isArray(this.internalValue)},isActive:function(){var t=this,e=this.value,i=this.internalValue;return this.isMultiple?!!Array.isArray(i)&&i.some((function(i){return t.valueComparator(i,e)})):void 0===this.trueValue||void 0===this.falseValue?e?this.valueComparator(e,i):Boolean(i):this.valueComparator(i,this.trueValue)},isDirty:function(){return this.isActive},rippleState:function(){return this.disabled||this.validationState?this.validationState:void 0}},watch:{inputValue:function(t){this.lazyValue=t,this.hasColor=t}},methods:{genLabel:function(){var t=this,e=s["a"].options.methods.genLabel.call(this);return e?(e.data.on={click:function(e){e.preventDefault(),t.onChange()}},e):e},genInput:function(t,e){return this.$createElement("input",{attrs:Object.assign({"aria-checked":this.isActive.toString(),disabled:this.isDisabled,id:this.computedId,role:t,type:t},e),domProps:{value:this.value,checked:this.isActive},on:{blur:this.onBlur,change:this.onChange,focus:this.onFocus,keydown:this.onKeydown},ref:"input"})},onBlur:function(){this.isFocused=!1},onChange:function(){var t=this;if(!this.isDisabled){var e=this.value,i=this.internalValue;if(this.isMultiple){Array.isArray(i)||(i=[]);var s=i.length;i=i.filter((function(i){return!t.valueComparator(i,e)})),i.length===s&&i.push(e)}else i=void 0!==this.trueValue&&void 0!==this.falseValue?this.valueComparator(i,this.trueValue)?this.falseValue:this.trueValue:e?this.valueComparator(i,e)?null:e:!i;this.validate(!0,i),this.internalValue=i,this.hasColor=i}},onFocus:function(){this.isFocused=!0},onKeydown:function(t){}}})}}]);
//# sourceMappingURL=mhero.0123262a.js.map