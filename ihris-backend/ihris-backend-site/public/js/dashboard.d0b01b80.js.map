{"version":3,"file":"js/dashboard.d0b01b80.js","mappings":"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","sources":["webpack://iHRIS-v5/./src/views/dashboard.vue?6638","webpack://iHRIS-v5/./src/components/fhir/fhir-reference-dashboard.vue?8063","webpack://iHRIS-v5/src/components/fhir/fhir-reference-dashboard.vue","webpack://iHRIS-v5/./src/components/fhir/fhir-reference-dashboard.vue?5a2c","webpack://iHRIS-v5/./src/components/fhir/fhir-reference-dashboard.vue","webpack://iHRIS-v5/src/views/dashboard.vue","webpack://iHRIS-v5/./src/views/dashboard.vue?8d89","webpack://iHRIS-v5/./src/views/dashboard.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',[_c('v-card-title',[_c('v-row',[_c('v-col',[_c('h4',{staticClass:\"font-weight-medium\"},[_c('v-icon',{staticClass:\"mr-2\",attrs:{\"color\":\"primary\",\"size\":\"28\"}},[_vm._v(\"mdi-tablet-dashboard\")]),_vm._v(\" Dashboard \")],1)]),_c('v-col',{staticClass:\"ml-2\"},[_c('v-row',{attrs:{\"justify\":\"end\"},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_c('h5',{staticClass:\"description\"},[_vm._v(\"Filter By: \")])]},proxy:true}])},[_c('fhir-reference-dashboard',{attrs:{\"initialValue\":(\"Location/\" + (_vm.getData.location)),\"baseMax\":\"1\",\"baseMin\":\"0\",\"constraints\":\"undefined\",\"display-type\":\"tree\",\"edit\":\"true\",\"field\":\"partOf\",\"label\":\"Region/District/SubCounty/Facility\",\"max\":\"1\",\"min\":\"0\",\"path\":\"Location.partOf\",\"readOnlyIfSet:undefined\":\"\",\"sliceName:undefined\":\"\",\"slotProps:Object\":\"\",\"source:Object\":\"\",\"subFields:undefined\":\"\",\"targetResource\":\"Location\"},on:{\"selectFacilityForDashboard\":_vm.onSelectedFacility}})],1)],1)],1)],1),_c('v-divider'),_c('v-card-text',{staticStyle:{\"height\":\"90vh\"}},[(_vm.selectedFacility)?_c('iframe',{staticStyle:{\"border\":\"none\"},attrs:{\"src\":(\"/dashboards/app/dashboards#/view/\" + (_vm.$route.params.id) + \"?embed=true&_a=(description:'',filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,key:ihris-related-group.keyword,negate:!f,params:(query:'\" + _vm.selectedFacility + \"'),type:phrase),query:(match_phrase:(ihris-related-group:'\" + _vm.selectedFacility + \"')))))&hide-filter-bar=true\"),\"height\":\"100%\",\"width\":\"100%\"}}):_vm._e(),(_vm.getData.location && !_vm.selectedFacility)?_c('iframe',{staticStyle:{\"border\":\"none\"},attrs:{\"src\":(\"/dashboards/app/dashboards#/view/\" + (_vm.$route.params.id) + \"?embed=true&_a=(description:'',filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,key:ihris-related-group.keyword,negate:!f,params:(query:'Location/\" + (_vm.getData.location) + \"'),type:phrase),query:(match_phrase:(ihris-related-group:'Location/\" + (_vm.getData.location) + \"')))))&hide-filter-bar=true\"),\"height\":\"100%\",\"width\":\"100%\"}}):_vm._e(),(!_vm.getData.location && !_vm.selectedFacility)?_c('iframe',{staticStyle:{\"border\":\"none\"},attrs:{\"src\":'/dashboards/app/dashboards#/view/'+_vm.$route.params.id+'?embed=true',\"height\":\"100%\",\"width\":\"100%\"}}):_vm._e()])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ihris-element',{attrs:{\"edit\":_vm.edit,\"loading\":_vm.loading},scopedSlots:_vm._u([{key:\"form\",fn:function(){return [(_vm.displayType == 'tree')?_c('v-menu',{ref:\"menu\",attrs:{\"close-on-content-click\":false,\"max-height\":\"500px\",\"min-width\":\"290px\",\"offset-y\":\"\",\"transition\":\"scale-transition\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nreturn [_c('v-text-field',_vm._g({attrs:{\"disabled\":_vm.disabledAll || _vm.disabled,\"error-messages\":_vm.errors,\"label\":_vm.display,\"loading\":_vm.loading,\"rules\":_vm.rules,\"append-icon\":\"mdi-arrow-down-drop-circle-outline\",\"dense\":\"\",\"hide-details\":\"auto\",\"outlined\":\"\",\"readonly\":\"\"},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_vm._v(_vm._s(_vm.display)+\" \"),(_vm.required)?_c('span',{staticClass:\"red--text font-weight-bold\"},[_vm._v(\"*\")]):_vm._e()]},proxy:true}],null,true),model:{value:(_vm.displayValue),callback:function ($$v) {_vm.displayValue=$$v},expression:\"displayValue\"}},on))]}}],null,false,881804525),model:{value:(_vm.menu),callback:function ($$v) {_vm.menu=$$v},expression:\"menu\"}},[(!((_vm.disabled) || (_vm.preset && _vm.$route.name === 'resource_add')))?_c('v-card',[_c('v-treeview',{attrs:{\"active\":_vm.active,\"items\":_vm.items,\"load-children\":_vm.fetchChildren,\"loading\":_vm.loading,\"multiple-active\":false,\"open\":_vm.open,\"activatable\":\"\",\"item-disabled\":\"locked\",\"return-object\":\"\",\"selection-type\":\"independent\"},on:{\"update:active\":function($event){_vm.active=$event},\"update:open\":function($event){_vm.open=$event}}})],1):_vm._e()],1):_vm._e()]},proxy:true},{key:\"header\",fn:function(){return [_vm._v(\" \"+_vm._s(_vm.display)+\" \")]},proxy:true},{key:\"value\",fn:function(){return [_vm._v(\" \"+_vm._s(_vm.displayValue)+\" \")]},proxy:true}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <ihris-element :edit=\"edit\" :loading=\"loading\">\n    <template #form>\n      <v-menu\n          v-if=\"displayType == 'tree'\"\n          ref=\"menu\"\n          v-model=\"menu\"\n          :close-on-content-click=\"false\"\n          max-height=\"500px\"\n          min-width=\"290px\"\n          offset-y\n          transition=\"scale-transition\"\n      >\n        <template v-slot:activator=\"{ on }\">\n          <v-text-field\n              v-model=\"displayValue\"\n              :disabled=\"disabledAll || disabled\"\n              :error-messages=\"errors\"\n              :label=\"display\"\n              :loading=\"loading\"\n              :rules=\"rules\"\n              append-icon=\"mdi-arrow-down-drop-circle-outline\"\n              dense\n              hide-details=\"auto\"\n              outlined\n              readonly\n              v-on=\"on\">\n            <template #label>{{ display }} <span v-if=\"required\" class=\"red--text font-weight-bold\">*</span></template>\n          </v-text-field>\n        </template>\n        <v-card v-if=\"!((disabled) || (preset && $route.name === 'resource_add'))\">\n          <v-treeview\n              :active.sync=\"active\"\n              :items=\"items\"\n              :load-children=\"fetchChildren\"\n              :loading=\"loading\"\n              :multiple-active=\"false\"\n              :open.sync=\"open\"\n              activatable\n              item-disabled=\"locked\"\n              return-object\n              selection-type=\"independent\"\n          ></v-treeview>\n        </v-card>\n      </v-menu>\n    </template>\n    <template #header>\n      {{ display }}\n    </template>\n    <template #value>\n      {{ displayValue }}\n    </template>\n  </ihris-element>\n</template>\n\n<script>\nimport IhrisElement from \"../ihris/ihris-element.vue\"\n\nconst querystring = require('querystring')\nconst fhirurl = \"http://hl7.org/fhir/StructureDefinition/\"\nexport default {\n  name: \"fhir-reference-dashboard\",\n  props: [\"field\", \"label\", \"sliceName\", \"targetProfile\", \"targetResource\", \"min\", \"max\", \"base-min\", \"base-max\",\n    \"slotProps\", \"path\", \"sub-fields\", \"edit\", \"readOnlyIfSet\", \"constraints\", \"displayType\", \"initialValue\", \"overrideValue\"],\n  components: {\n    IhrisElement\n  },\n  data: function () {\n    return {\n      source: {path: \"\", data: {}},\n      value: {reference: \"\"},\n      qField: \"valueReference\",\n      loading: false,\n      search: \"\",\n      menu: false,\n      items: [],\n      select: \"\",\n      resource: \"\",\n      awaitingSearch: false,\n      displayValue: \"\",\n      preset: false,\n      disabled: false,\n      disabledAll: false,\n      errors: [],\n      lockWatch: false,\n      active: [],\n      open: [],\n      treeLookup: {},\n      allAllowed: true,\n      isFacility: false\n    }\n  },\n  created: function () {\n    this.setupData()\n  },\n  watch: {\n    slotProps: {\n      handler() {\n        if (!this.lockWatch) {\n          this.setupData()\n        }\n      },\n      deep: true,\n    },\n    search: function (val) {\n      if (!this.awaitingSearch) {\n        setTimeout(() => {\n          val && val.length > 1 && this.querySelections(this.search)\n          this.awaitingSearch = false\n        }, 500)\n      }\n      this.awaitingSearch = true\n    },\n    select: function (val) {\n      if (this.$route.path === \"/dashboard/\"+this.$route.params.id) {\n        this.$emit(\"selectFacilityForDashboard\", val);\n      }\n      this.value.reference = val\n      this.getDisplay()\n    },\n    active: function () {\n      if (this.active.length) {\n        this.select = this.active[0]\n        this.displayValue = this.treeLookup[this.select.id]\n      } else {\n        this.select = undefined\n        this.displayValue = \"\"\n      }\n      this.menu = false\n    }\n  },\n  methods: {\n    setupData: function () {\n      this.targetResource = \"Location\"\n      this.targetProfile = \"Location\"\n      if (this.targetProfile && this.targetResource) {\n        if (this.targetProfile.replace(fhirurl, \"\") === this.targetResource) {\n          this.allAllowed = true\n        } else {\n          this.allAllowed = false\n        }\n        this.resource = this.targetResource\n      }\n      if (this.displayType === \"tree\") {\n        this.setupTreeItems()\n      }\n      if (this.slotProps && this.slotProps.source) {\n        this.source = {path: this.slotProps.source.path + \".\" + this.field, data: {}}\n        if (this.slotProps.source.fromArray) {\n          this.source.data = this.slotProps.source.data\n        } else {\n          let expression = this.$fhirutils.pathFieldExpression(this.field)\n          let results = this.$fhirpath.evaluate(this.slotProps.source.data, expression)\n          this.source.data = results[0]\n        }\n        if (this.source.data) {\n          this.preset = true\n          this.select = this.source.data.reference\n          this.lockWatch = true\n        }\n      }\n      this.disabled = this.readOnlyIfSet && this.preset\n    },\n    setupTreeItems: async function () {\n      let treetop = this.initialValue\n      if ( this.overrideValue ) {\n        treetop = this.overrideValue\n      }\n      this.loading = true\n      let params = {} \n      if ( treetop ) {\n        params = { \"partof\": treetop }\n      } else {\n        params = { \"partof:missing\": true }\n      }\n      params._count = 500\n      let url = \"/fhir/\"+this.resource+\"?_sort=name&\"+querystring.stringify( params )\n      this.items = []\n      this.addItems( url, this.items )\n    },\n    checkFacility: function (id) {\n      let params = {\n        \"_id\": id,\n        \"_profile\": \"http://ihris.org/fhir/StructureDefinition/ihris-facility\",\n        \"_summary\": \"count\"\n      }\n      let url = \"/fhir/\" + this.resource + \"?_sort=name\" + \"&\" + querystring.stringify(params)\n      return new Promise(resolve => {\n        fetch(url).then(response => {\n          if (response.ok) {\n            response.json().then(data => {\n              if (data.total && data.total == 1) {\n                this.isFacility = true\n              }\n              resolve()\n            }).catch(err => {\n              console.log(\"failed to check facility for\", url, err)\n              resolve()\n            })\n          } else {\n            console.log(\"failed to check facility for\", url, response.status)\n            resolve()\n          }\n        }).catch(err => {\n          console.log(\"failed to check facility for\", url, err)\n          resolve()\n        })\n      })\n    },\n    checkChildren: function (item) {\n      let params = {\"partof\": item.id, \"_summary\": \"count\"}\n      let url = \"/fhir/\" + this.resource + \"?_sort=name\" + \"&\" + querystring.stringify(params)\n      return new Promise(resolve => {\n        fetch(url).then(response => {\n          if (response.ok) {\n            response.json().then(data => {\n              if (data.total && data.total > 0) {\n                item.children = []\n              }\n              resolve()\n            }).catch(err => {\n              console.log(\"failed to check children for\", url, err)\n              resolve()\n            })\n          } else {\n            console.log(\"failed to check children for\", url, response.status)\n            resolve()\n          }\n        }).catch(err => {\n          console.log(\"failed to check children for\", url, err)\n          resolve()\n        })\n      })\n    },\n    addItems: function (url, items) {\n      fetch(url).then(response => {\n        if (response.ok) {\n          response.json().then(async data => {\n            if (data.entry && data.entry.length > 0) {\n              for (let entry of data.entry) {\n                let locked = this.allAllowed ? false : !entry.resource.meta.profile.includes( this.targetProfile )\n                let item = { \n                  id: entry.resource.resourceType+\"/\"+entry.resource.id,\n                  name: entry.resource.name,\n                  locked: locked\n                }\n                await this.checkChildren( item )\n                this.treeLookup[ item.id ] = item.name\n                items.push( item )\n              }\n            }\n            if (data.link) {\n              let next = data.link.find(link => link.relation === \"next\")\n              if (next) {\n                this.addItems(next.url, items)\n              } else {\n                this.loading = false\n              }\n            } else {\n              this.loading = false\n            }\n          }).catch(err => {\n            console.log(\"Failed to add items for\", url, err)\n            this.loading = false\n          })\n        } else {\n          console.log(\"Failed to add items for\", url, response.status)\n          this.loading = false\n        }\n      }).catch(err => {\n        console.log(\"Failed to add items for\", url, err)\n        this.loading = false\n      })\n    },\n    fetchChildren: function (item) {\n      let params = {\"partof\": item.id, \"_count\": 1000}\n      let url = \"/fhir/\" + this.resource + \"?_sort=name\" + \"&\" + querystring.stringify(params)\n      this.loading = true\n      this.addItems( url, item.children )\n      return new Promise(resolve => {\n        let count = 0\n        const checkLoading = () => {\n          if (!this.loading || count++ > 200) {\n            resolve()\n          } else {\n            setTimeout(checkLoading, 200)\n          }\n        }\n        checkLoading()\n      })\n    },\n    querySelections: function (val) {\n      this.loading = true\n      let params = {\"name:contains\": val}\n      if (!this.targetProfile.endsWith(this.resource)) {\n        params._profile = this.targetProfile\n      }\n      let url = \"/fhir/\" + this.resource + \"?_sort=name\" + \"&\" + querystring.stringify(params)\n      fetch(url).then(response => {\n        if (response.ok) {\n          response.json().then(async (data) => {\n            this.items = []\n            if (data.entry && data.entry.length) {\n              for (let entry of data.entry) {\n                let ref = entry.resource.resourceType + \"/\" + entry.resource.id\n                let item = {value: ref}\n                item.text = await this.$fhirutils.resourceLookup(ref)\n                this.items.push(item)\n              }\n            }\n            this.loading = false\n          })\n        } else {\n          console.log(\"Failed to retrieve\", this.resource)\n          this.loading = false\n        }\n      })\n    },\n    getDisplay: function () {\n      if ((!this.edit || this.preset) && this.value && this.value.reference) {\n        this.loading = true\n        this.$fhirutils.resourceLookup(this.value.reference).then(display => {\n          this.displayValue = display\n          if (!this.edit && this.targetProfile === \"http://ihris.org/fhir/StructureDefinition/ihris-jurisdiction\") {\n            let params = {\n              _id: this.value.reference.split('/').pop(), status: \"active\", \"_include:iterate\": \"Location:partof\",\n            };\n            let url = \"/fhir/Location?_sort=name\" + \"&\" + querystring.stringify(params)\n            let locations = []\n            let type = []\n            //let type = [\"region\", \"district\", \"subcounty\"]\n            fetch(url).then(response => {\n              if (response.ok) {\n                response.json().then((response) => {\n                  for (let loc of type) {\n                    let res = response.entry.find(x => x.resource.type[0].coding[0].code == loc)\n                    locations.push(res.resource.name)\n                  }\n                  this.displayValue = locations.join(',')\n                })\n              }\n            })\n          } else {\n            this.displayValue = display\n          }\n          if (this.displayType !== \"tree\") {\n            this.items.push({text: display, value: this.value.reference})\n          }\n          this.loading = false\n        })\n      }\n    },\n  },\n  computed: {\n    index: function () {\n      if (this.slotProps) return this.slotProps.input\n      else return undefined\n    },\n    display: function () {\n      if (this.slotProps && this.slotProps.input) return this.slotProps.input.label\n      else return this.label\n    },\n    required: function () {\n      return (this.index || 0) < this.min\n    },\n    rules: function () {\n      if (this.required) {\n        return [v => !!v || this.display + \" is required\"]\n      } else {\n        return []\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./fhir-reference-dashboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./fhir-reference-dashboard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./fhir-reference-dashboard.vue?vue&type=template&id=089001b7&\"\nimport script from \"./fhir-reference-dashboard.vue?vue&type=script&lang=js&\"\nexport * from \"./fhir-reference-dashboard.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VTreeview } from 'vuetify/lib/components/VTreeview';\ninstallComponents(component, {VCard,VMenu,VTextField,VTreeview})\n","<template>\n  <v-card>\n    <v-card-title>\n      <v-row>\n        <v-col>\n          <h4 class=\"font-weight-medium\">\n            <v-icon class=\"mr-2\" color=\"primary\" size=\"28\">mdi-tablet-dashboard</v-icon>\n            Dashboard\n          </h4>\n        </v-col>\n        <v-col class=\"ml-2\">\n          <v-row justify=\"end\">\n            <!--<v-switch\n                v-model=\"partOf\"\n                color=\"indigo\"\n            >\n              <template #label>\n                <h5 class=\"description\">Include Data from Selected District/Facility only</h5>\n              </template>\n            </v-switch>-->\n            <template #label>\n                <h5 class=\"description\">Filter By: </h5>\n            </template>\n            <fhir-reference-dashboard\n                :initialValue=\"`Location/${getData.location}`\"\n                baseMax=\"1\"\n                baseMin=\"0\"\n                constraints=undefined\n                display-type=\"tree\"\n                edit=true\n                field=\"partOf\"\n                label=\"Region/District/SubCounty/Facility\"\n                max=\"1\"\n                min=\"0\"\n                path=\"Location.partOf\"\n                readOnlyIfSet:undefined\n                sliceName:undefined\n                slotProps:Object\n                source:Object\n                subFields:undefined\n                targetResource=\"Location\"\n                @selectFacilityForDashboard=\"onSelectedFacility\"\n            >\n            </fhir-reference-dashboard>\n          </v-row>\n        </v-col>\n      </v-row>\n    </v-card-title>\n    <v-divider></v-divider>\n    <v-card-text style=\"height: 90vh\">\n      <iframe\n         v-if=\"selectedFacility\"\n          :src=\"`/dashboards/app/dashboards#/view/${$route.params.id}?embed=true&_a=(description:'',filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,key:ihris-related-group.keyword,negate:!f,params:(query:'${selectedFacility}'),type:phrase),query:(match_phrase:(ihris-related-group:'${selectedFacility}')))))&hide-filter-bar=true`\"\n          height=\"100%\"\n          style=\"border: none;\"\n          width=\"100%\"\n      >\n      </iframe>\n      <iframe\n         v-if=\"getData.location && !selectedFacility\"\n          :src=\"`/dashboards/app/dashboards#/view/${$route.params.id}?embed=true&_a=(description:'',filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,key:ihris-related-group.keyword,negate:!f,params:(query:'Location/${getData.location}'),type:phrase),query:(match_phrase:(ihris-related-group:'Location/${getData.location}')))))&hide-filter-bar=true`\"\n          height=\"100%\"\n          style=\"border: none;\"\n          width=\"100%\"\n      ></iframe>\n     <iframe\n         v-if=\"!getData.location && !selectedFacility\"\n          :src=\"'/dashboards/app/dashboards#/view/'+$route.params.id+'?embed=true'\"\n          height=\"100%\"\n          style=\"border: none;\"\n          width=\"100%\"\n      ></iframe>\n    </v-card-text>\n  </v-card>\n</template>\n<script>\nimport FhirReferenceDashboard from \"@/components/fhir/fhir-reference-dashboard.vue\";\n\nexport default {\n  name: \"dashboard\",\n  components: {FhirReferenceDashboard},\n  props: [ \"id\" ],\n  data() {\n    return {\n      selectedFacility: '',\n      facilityName: ''\n    }\n  },\n  methods: {\n    onSelectedFacility: function (value) {\n      this.selectedFacility = value.id\n      this.facilityName = value.name\n      console.log(\"Selected Location\", this.selectedFacility, this.facilityName)\n    }\n  },\n  computed: {\n    getData() {\n      return this.$store.state.user\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./dashboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./dashboard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./dashboard.vue?vue&type=template&id=1a0de637&\"\nimport script from \"./dashboard.vue?vue&type=script&lang=js&\"\nexport * from \"./dashboard.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VCard,VCardText,VCardTitle,VCol,VDivider,VIcon,VRow})\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","scopedSlots","_u","key","fn","proxy","getData","on","onSelectedFacility","staticStyle","$route","params","selectedFacility","_e","location","id","staticRenderFns","edit","loading","displayType","ref","_g","disabledAll","disabled","errors","display","rules","_s","model","value","callback","$$v","displayValue","expression","menu","preset","name","active","items","fetchChildren","open","$event","querystring","fhirurl","props","components","IhrisElement","data","source","path","reference","qField","search","select","resource","awaitingSearch","lockWatch","treeLookup","allAllowed","isFacility","created","watch","slotProps","handler","deep","setTimeout","val","methods","setupData","setupTreeItems","treetop","checkFacility","fetch","response","resolve","catch","err","console","checkChildren","item","addItems","locked","checkLoading","querySelections","getDisplay","_id","status","locations","text","computed","index","required","component","VCard","FhirReferenceDashboard","facilityName"],"sourceRoot":""}