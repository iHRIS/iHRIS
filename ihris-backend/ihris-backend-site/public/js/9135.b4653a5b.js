"use strict";(self["webpackChunkiHRIS_v5"]=self["webpackChunkiHRIS_v5"]||[]).push([[9135],{35098:function(e,t,i){i.d(t,{Z:function(){return h}});i(26699);var r=i(55648),s=i(98119),a=i(70172),o=i(2936),n=i(48085),l=i(36591),c=i(73325),d=i(71824),h=(0,c.Z)(r.Z,o.Z,l.Z).extend({name:"v-alert",props:{border:{type:String,validator(e){return["top","right","bottom","left"].includes(e)}},closeLabel:{type:String,default:"$vuetify.close"},coloredBorder:Boolean,dense:Boolean,dismissible:Boolean,closeIcon:{type:String,default:"$cancel"},icon:{default:"",type:[Boolean,String],validator(e){return"string"===typeof e||!1===e}},outlined:Boolean,prominent:Boolean,text:Boolean,type:{type:String,validator(e){return["info","error","success","warning"].includes(e)}},value:{type:Boolean,default:!0}},computed:{__cachedBorder(){if(!this.border)return null;let e={staticClass:"v-alert__border",class:{[`v-alert__border--${this.border}`]:!0}};return this.coloredBorder&&(e=this.setBackgroundColor(this.computedColor,e),e.class["v-alert__border--has-color"]=!0),this.$createElement("div",e)},__cachedDismissible(){if(!this.dismissible)return null;const e=this.iconColor;return this.$createElement(s.Z,{staticClass:"v-alert__dismissible",props:{color:e,icon:!0,small:!0},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:()=>this.isActive=!1}},[this.$createElement(a.Z,{props:{color:e}},this.closeIcon)])},__cachedIcon(){return this.computedIcon?this.$createElement(a.Z,{staticClass:"v-alert__icon",props:{color:this.iconColor}},this.computedIcon):null},classes(){const e={...r.Z.options.computed.classes.call(this),"v-alert--border":Boolean(this.border),"v-alert--dense":this.dense,"v-alert--outlined":this.outlined,"v-alert--prominent":this.prominent,"v-alert--text":this.text};return this.border&&(e[`v-alert--border-${this.border}`]=!0),e},computedColor(){return this.color||this.type},computedIcon(){return!1!==this.icon&&("string"===typeof this.icon&&this.icon?this.icon:!!["error","info","success","warning"].includes(this.type)&&`$${this.type}`)},hasColoredIcon(){return this.hasText||Boolean(this.border)&&this.coloredBorder},hasText(){return this.text||this.outlined},iconColor(){return this.hasColoredIcon?this.computedColor:void 0},isDark(){return!(!this.type||this.coloredBorder||this.outlined)||n.Z.options.computed.isDark.call(this)}},created(){this.$attrs.hasOwnProperty("outline")&&(0,d.fK)("outline","outlined",this)},methods:{genWrapper(){const e=[this.$slots.prepend||this.__cachedIcon,this.genContent(),this.__cachedBorder,this.$slots.append,this.$scopedSlots.close?this.$scopedSlots.close({toggle:this.toggle}):this.__cachedDismissible],t={staticClass:"v-alert__wrapper"};return this.$createElement("div",t,e)},genContent(){return this.$createElement("div",{staticClass:"v-alert__content"},this.$slots.default)},genAlert(){let e={staticClass:"v-alert",attrs:{role:"alert"},on:this.listeners$,class:this.classes,style:this.styles,directives:[{name:"show",value:this.isActive}]};if(!this.coloredBorder){const t=this.hasText?this.setTextColor:this.setBackgroundColor;e=t(this.computedColor,e)}return this.$createElement("div",e,[this.genWrapper()])},toggle(){this.isActive=!this.isActive}},render(e){const t=this.genAlert();return this.transition?e("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[t]):t}})},55533:function(e,t,i){i.d(t,{Z:function(){return a}});var r=i(48085),s=i(73325),a=(0,s.Z)(r.Z).extend({name:"v-subheader",props:{inset:Boolean},render(e){return e("div",{staticClass:"v-subheader",class:{"v-subheader--inset":this.inset,...this.themeClasses},attrs:this.$attrs,on:this.$listeners},this.$slots.default)}})},36591:function(e,t,i){var r=i(70538);t["Z"]=r["default"].extend({name:"transitionable",props:{mode:String,origin:String,transition:String}})},29936:function(e,t,i){i.r(t),i.d(t,{default:function(){return k}});var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{attrs:{"grid-list-xs":""}},[i("v-overlay",{attrs:{value:e.overlay}},[i("v-progress-circular",{attrs:{color:"primary",indeterminate:"",size:"50"}})],1),e.isMobile?e._e():i("v-navigation-drawer",{staticClass:"primary darken-1 white--text",staticStyle:{"z-index":"3"},attrs:{app:"",clipped:"",permanent:"",right:""}},[i("v-list",{staticClass:"white--text"},[i("v-list-item",["Inactive"===e.regStatus?i("v-row",[i("v-col",[e.valid?i("v-btn",{staticClass:"success darken-1",attrs:{disabled:!e.valid,dark:""},on:{click:function(t){return e.save()}}},[i("v-icon",{attrs:{light:""}},[e._v("mdi-content-save")]),i("span",[e._v(e._s(e.$t("App.hardcoded-texts.Renew Registration")))])],1):i("v-btn",{staticClass:"green",attrs:{dark:""},on:{click:function(t){return e.$refs.form.validate()}}},[i("v-icon",{attrs:{light:""}},[e._v("mdi-content-save")]),i("span",[e._v(e._s(e.$t("App.hardcoded-texts.Renew Registration")))])],1)],1)],1):e._e()],1)],1)],1),e.fullname?i("v-alert",{attrs:{type:"primary"}},[i("center",[i("b",[e._v(e._s(e.fullname))])])],1):e._e(),"Active"===e.regStatus?i("v-alert",{attrs:{dense:"",text:"",type:"success"}},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Your Registration is Already Active"))+" ")]):"Pending"===e.regStatus?i("v-alert",{attrs:{dense:"",text:"",type:"warning"}},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Your Registration is Pending Waiting Approval From Registration Offices"))+" ")]):"Inactive"===e.regStatus&&"new"!==e.regStatusCode?i("v-alert",{attrs:{dense:"",outlined:"",type:"error"}},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Your registration has expired, kindly fill below details to renew"))+" ")]):"new"===e.regStatusCode?i("v-alert",{attrs:{dense:"",outlined:"",type:"error"}},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Your application has been accepted, kindly fill below details to complete registration"))+" ")]):e._e(),e.familyMembersPaidFee?e._e():i("v-alert",{attrs:{dense:"",text:"",type:"warning"}},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Some of your family members will not be registered as they havent paid fee"))+" ")]),e.payments.required>0&&0===e.payments.pending?i("v-row",{attrs:{justify:"center"}},[i("v-col",{attrs:{cols:"12",md:"8"}},[i("v-card",{staticClass:"pa-6 elevation-3",attrs:{outlined:"",color:"#e8f5e9"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"2"}},[i("v-icon",{attrs:{size:"48",color:"green darken-2"}},[e._v("mdi-check-decagram")])],1),i("v-col",{attrs:{cols:"12",md:"10"}},[i("h2",{staticClass:"font-weight-bold mb-2 success--text"},[e._v("Payment Completed!")]),i("p",{staticClass:"subtitle-1"},[e._v(" Congratulations! You have successfully completed payment of fees. ")])])],1),i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-card",{staticClass:"pa-4",attrs:{outlined:""}},[i("h3",{staticClass:"font-weight-medium mb-3"},[e._v("Payment Summary")]),i("v-row",[i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-chip",{staticClass:"ma-1",attrs:{outlined:"",color:"blue","text-color":"blue darken-2",label:""}},[e._v(" Required: "),i("strong",{staticClass:"ml-2"},[e._v("TZS "+e._s(e.payments.required.toLocaleString()))])])],1),i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-chip",{staticClass:"ma-1",attrs:{outlined:"",color:"green","text-color":"green darken-2",label:""}},[e._v(" Paid: "),i("strong",{staticClass:"ml-2"},[e._v("TZS "+e._s(e.payments.paid.toLocaleString()))])])],1),i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-chip",{staticClass:"ma-1",attrs:{outlined:"",color:"grey lighten-1","text-color":"grey darken-3",label:""}},[e._v(" Pending: "),i("strong",{staticClass:"ml-2"},[e._v("TZS "+e._s(e.payments.pending.toLocaleString()))])])],1)],1)],1)],1)],1),i("v-alert",{staticClass:"mt-6",attrs:{type:"info","colored-border":"",border:"left",elevation:"2",color:"blue lighten-5"}},[i("v-icon",{attrs:{left:"",color:"blue darken-2"}},[e._v("mdi-information")]),e._v(" You may now proceed to the next step of your registration. ")],1)],1)],1)],1):e._e(),e.payments.pending>0?i("v-row",{attrs:{justify:"center"}},[i("v-col",{attrs:{cols:"12",md:"8"}},[i("v-card",{staticClass:"pa-6 elevation-3",attrs:{outlined:"",color:"#fffbe6"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",{staticClass:"text-center",attrs:{cols:"12",md:"2"}},[i("v-icon",{attrs:{size:"48",color:"orange darken-2"}},[e._v("mdi-check-circle")])],1),0===e.payments.paid?i("v-col",{attrs:{cols:"12",md:"10"}},[i("h2",{staticClass:"font-weight-bold mb-2"},[e._v("Action Required!")]),i("p",{staticClass:"subtitle-1"},[i("strong",[e._v("First step of registration is successful!")]),e._v(" To finish your registration, please pay fees by visiting any CRDB branch or authorized CRDB agent or SIM Banking App using below control number: ")])]):e.payments.pending>0?i("v-col",{attrs:{cols:"12",md:"10"}},[i("h2",{staticClass:"font-weight-bold mb-2"},[e._v("Action Required!")]),i("p",{staticClass:"subtitle-1"},[e._v(" Please complete payment of fees by visiting any CRDB branch or authorized CRDB agent or SIM Banking App using below control number: ")])]):e._e()],1),i("v-divider",{staticClass:"my-4"}),i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-alert",{staticClass:"mb-4",attrs:{type:"info",border:"left","colored-border":"",elevation:"2",color:"blue lighten-5"}},[i("h3",{staticClass:"font-weight-bold mb-2"},[e._v("Your Payment Control Number")]),i("p",{staticClass:"display-1 font-mono primary--text"},[e._v(e._s(e.controlNumber))])])],1)],1),i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-card",{staticClass:"pa-4",attrs:{outlined:""}},[i("h3",{staticClass:"font-weight-medium mb-3"},[e._v("Payment Status")]),i("v-row",[i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-chip",{staticClass:"ma-1",attrs:{outlined:"",color:"blue","text-color":"blue darken-2",label:""}},[e._v(" Required: "),i("strong",{staticClass:"ml-2"},[e._v("TZS "+e._s(e.payments.required.toLocaleString()))])])],1),i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-chip",{staticClass:"ma-1",attrs:{outlined:"",color:"green","text-color":"green darken-2",label:""}},[e._v(" Paid: "),i("strong",{staticClass:"ml-2"},[e._v("TZS "+e._s(e.payments.paid.toLocaleString()))])])],1),i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-chip",{staticClass:"ma-1",attrs:{outlined:"",color:"orange","text-color":"orange darken-2",label:""}},[e._v(" Pending: "),i("strong",{staticClass:"ml-2"},[e._v("TZS "+e._s(e.payments.pending.toLocaleString()))])])],1)],1)],1)],1)],1),e.payments.pending>0?i("v-alert",{staticClass:"mt-6",attrs:{type:"warning","colored-border":"",border:"left",elevation:"2",color:"amber lighten-4"}},[i("v-icon",{attrs:{left:"",color:"orange darken-3"}},[e._v("mdi-alert-circle")]),e._v(" Please make sure to complete the payment to proceed with the next steps of registration. ")],1):e._e()],1)],1)],1):e._e(),i("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[i("v-card-title",{attrs:{"primary-title":""}},[e._v(" Viwango Vya Ada ")]),i("v-card-text",[i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Boarding:")])]),i("v-col",{attrs:{cols:"8"}},[e._v("TZS 600,000/=")])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Mutafarrighati:")])]),i("v-col",{attrs:{cols:"8"}},[e._v("TZS 300,000/=")])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Familia ya watu 1-5:")])]),i("v-col",{attrs:{cols:"8"}},[e._v("TZS 100,000/=")])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Familia ya watu 6-9:")])]),i("v-col",{attrs:{cols:"8"}},[e._v("TZS 150,000/=")])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Familia ya watu 10 na zaidi:")])]),i("v-col",{attrs:{cols:"8"}},[e._v("TZS 200,000/=")])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Family Member:")])]),i("v-col",{attrs:{cols:"8"}},[e._v("TZS 0/=")])],1)],1)],1),i("v-form",{ref:"form",attrs:{id:"app"},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.registration.stream?i("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[i("v-card-title",{staticClass:"primary darken-1 white--text text-uppercase font-weight-bold"},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Registration Information"))+" ("+e._s(e.registration.academicYear.academicYear)+") ")]),e.edit?i("v-card-text",{staticClass:"my-3"},[i("fhir-choice",{attrs:{field:"unit",initial:e.unit,slotProps:{source:{path:"unit",data:[]}},edit:!0,path:"unit",displayCondition:"",id:"PractitionerRole.extension:maahad-unit.value[x]:valueCoding",definition:"http://ihris.org/fhir/StructureDefinition/itsf-practitioner-role#PractitionerRole.extension:maahad-unit.value[x]:valueCoding",label:"Unit",binding:"http://ihris.org/fhir/ValueSet/itsf-maahad-unit-valueset",min:"1",max:"1"}}),i("fhir-choice",{attrs:{field:"stream",initial:e.stream,slotProps:{source:{path:"stream",data:[]}},edit:!0,path:"stream",displayCondition:"",id:"PractitionerRole.extension:maahad-stream.value[x]:valueCoding",definition:"http://ihris.org/fhir/StructureDefinition/itsf-practitioner-role#PractitionerRole.extension:maahad-stream.value[x]:valueCoding",label:"Stream",binding:"http://ihris.org/fhir/ValueSet/itsf-maahad-stream-valueset",min:"1",max:"1"}}),i("fhir-choice",{attrs:{field:"accomodation",initial:e.accomodation,slotProps:{source:{path:"accomodation",data:[]}},edit:!0,path:"accomodation",displayCondition:"",id:"PractitionerRole.extension:acommodation.value[x]:valueCoding",definition:"http://ihris.org/fhir/StructureDefinition/itsf-practitioner-role#PractitionerRole.extension:acommodation.value[x]:valueCoding",label:"Accomodation",binding:"http://ihris.org/fhir/ValueSet/itsf-accomodation-valueset",min:"1",max:"1"}}),i("fhir-choice",{attrs:{field:"student_type",initial:e.student_type,slotProps:{source:{path:"student_type",data:[]}},edit:!0,path:"student_type",displayCondition:"",id:"PractitionerRole.extension:student-type.value[x]:valueCoding",definition:"http://ihris.org/fhir/StructureDefinition/itsf-practitioner-role#PractitionerRole.extension:student-type.value[x]:valueCoding",label:"Student Category",binding:"http://ihris.org/fhir/ValueSet/itsf-student-type-valueset",min:"1",max:"1"}}),i("fhir-reference",{attrs:{field:"school_fees_type",initial:e.school_fees_type,slotProps:{source:{path:"school_fees_type",data:[]}},edit:!0,path:"school_fees_type",displayCondition:"","search-parameter":"feestype",id:"PractitionerRole.extension:school-fees-type.value[x]:valueReference",definition:"http://ihris.org/fhir/StructureDefinition/itsf-practitioner-role#PractitionerRole.extension:school-fees-type.value[x]:valueReference",targetProfile:"http://ihris.org/fhir/StructureDefinition/itsf-school-fees-types",targetResource:"Basic",label:"Fees Category",displayType:"preloaded",min:"1",max:"1"}}),i("fhir-choice",{attrs:{field:"family_head_category",initial:e.family_head_category,slotProps:{source:{path:"family_head_category",data:[]}},edit:!0,path:"family_head_category",displayCondition:"school_fees_type|=|Basic/familyfive+=school_fees_type|=|Basic/familynine+=school_fees_type|=|Basic/familyinfinity",enableBehavior:"any",id:"PractitionerRole.extension:family-head-category.value[x]:valueCoding",definition:"http://ihris.org/fhir/StructureDefinition/itsf-practitioner-role#PractitionerRole.extension:family-head-category.value[x]:valueCoding",label:"Family Head Category",binding:"http://ihris.org/fhir/ValueSet/itsf-family-head-category-valueset",min:"1",max:"1"}}),i("fhir-reference",{attrs:{field:"family_head",initial:e.family_head,slotProps:{source:{path:"family_head",data:[]}},edit:!0,path:"family_head",id:"Basic.extension:head.value[x]:valueReference",definition:"http://ihris.org/fhir/StructureDefinition/itsf-family-head-profile#Basic.extension:head.value[x]:valueReference",report:"ihris-es-itsf-family-head",reportReturnValue:"ihris-es-itsf-family-head.id",referenceDisplayPath:"name.where(use='official').given.first() + ' ' + name.where(use='official').family",label:"Family Head",displayType:"reportSelect",min:"0",max:"1"}})],1):i("v-card-text",{staticClass:"my-3"},[i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Unit:")])]),i("v-col",{attrs:{cols:"8"}},[e._v(e._s(e.registration.unit))])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[i("b",[e._v("Stream:")])])]),i("v-col",{attrs:{cols:"8"}},[i("b",[e._v(e._s(e.registration.stream))])])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Accomodation:")])]),i("v-col",{attrs:{cols:"8"}},[e._v(e._s(e.registration.acommodation))])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Student Category:")])]),i("v-col",{attrs:{cols:"8"}},[e._v(e._s(e.registration.student_category))])],1),i("v-divider"),i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Fees Category:")])]),i("v-col",{attrs:{cols:"8"}},[e._v(e._s(e.registration.fees_category.name)+" "),i("br"),e._v(" TZS "+e._s(e.registration.fees_category.amount.toLocaleString())+"/=")])],1),e.registration.family_head_category?i("v-divider"):e._e(),e.registration.family_head_category?i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Family Head Category:")])]),i("v-col",{attrs:{cols:"8"}},[e._v(e._s(e.registration.family_head_category))])],1):e._e(),e.registration.family_head?i("v-divider"):e._e(),e.registration.family_head?i("v-row",{staticClass:"justify-space-between"},[i("v-col",{attrs:{cols:"4"}},[i("span",{staticClass:"font-weight-bold"},[e._v("Family Head:")])]),i("v-col",{attrs:{cols:"8"}},[e._v(e._s(e.registration.family_head))])],1):e._e(),"Inactive"===e.regStatus?i("v-row",{staticClass:"justify-space-between"},[i("v-spacer"),i("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.edit=!0}}},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Edit"))+" ")])],1):e._e()],1)],1):e._e(),e.members.length?i("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[i("v-card-title",{staticClass:"primary darken-1 white--text text-uppercase font-weight-bold"},[e._v(" "+e._s(e.members.length)+" "+e._s(e.$t("App.hardcoded-texts.Family Members To Be Included On This Renewal"))+" ")]),i("v-alert",{attrs:{dense:"",text:"",type:"success"}},[e._v(" "+e._s(e.$t("App.hardcoded-texts.Contact registration office if you dont recognise any of the family members"))+" ")]),i("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.membersHeaders,items:e.members,"item-key":"name",search:e.searchMember},scopedSlots:e._u([{key:"top",fn:function(){return[i("v-text-field",{staticClass:"mx-4",attrs:{label:"Search"},model:{value:e.searchMember,callback:function(t){e.searchMember=t},expression:"searchMember"}})]},proxy:!0}],null,!1,3681966928)})],1):e._e(),i("v-card",{staticClass:"mx-auto",attrs:{"max-width":"700",outlined:""}},[i("v-card-actions",["Inactive"===e.regStatus?i("v-row",[i("v-col",[i("v-btn",{staticClass:"error",attrs:{dark:""},on:{click:function(t){return e.$router.push("/custom/home?path=/itsf")}}},[i("v-icon",{attrs:{light:"",left:""}},[e._v("mdi-cancel")]),i("span",[e._v(e._s(e.$t("App.hardcoded-texts.Cancel")))])],1)],1),i("v-spacer"),i("v-col",[e.valid?i("v-btn",{staticClass:"success darken-1",attrs:{disabled:!e.valid,dark:""},on:{click:function(t){return e.save()}}},[i("v-icon",{attrs:{light:"",left:""}},[e._v("mdi-content-save")]),i("span",[e._v(e._s(e.$t("App.hardcoded-texts.Renew Registration")))])],1):i("v-btn",{staticClass:"green",attrs:{dark:""},on:{click:function(t){return e.$refs.form.validate()}}},[i("v-icon",{attrs:{light:"",left:""}},[e._v("mdi-content-save")]),i("span",[e._v(e._s(e.$t("App.hardcoded-texts.Renew Registration")))])],1)],1)],1):e._e()],1)],1),i("div",[e._v("Usajili")])],1)],1)},s=[],a={props:["queries"],data(){return{fullname:"",regStatus:"",regStatusCode:"",edit:!1,overlay:!1,registration:{},valid:!0,amount:0,pay_receipt:"",exemption_letter:"",pay_date:"",unit:"",stream:"",accomodation:"",student_type:"",school_fees_type:"",family_head_category:"",family_head:"",members:[],membersHeaders:[{text:this.$t("App.hardcoded-texts.Name"),value:"name"},{text:this.$t("App.hardcoded-texts.Registration Number"),value:"regNum"},{text:this.$t("App.hardcoded-texts.Fees Category"),value:"feecat"},{text:this.$t("App.hardcoded-texts.Required Fee"),value:"requiredfee"},{text:this.$t("App.hardcoded-texts.Paid Fee"),value:"paidfee"},{text:this.$t("App.hardcoded-texts.Pending Fee"),value:"pendingfee"}],searchMember:"",familyMembersPaidFee:!0,controlNumber:"",payments:{}}},computed:{isMobile(){return!(screen.width>760)}},components:{"fhir-choice":()=>Promise.all([i.e(3986),i.e(591),i.e(6049),i.e(6265),i.e(5814),i.e(1228),i.e(2251)]).then(i.bind(i,76101)),"fhir-reference":()=>Promise.all([i.e(3986),i.e(591),i.e(6049),i.e(6265),i.e(5814),i.e(1228),i.e(2251)]).then(i.bind(i,76265))},methods:{getActiveFamilyMembers(){fetch("/site/student/getFamilyMembers/"+this.queries.practitioner).then((e=>{e.ok?e.json().then((e=>{if(this.members=e,e.length)for(let t of this.members)fetch("/site/student/latestRegistration/"+t.id).then((e=>{e.ok&&e.json().then((e=>{t.requiredfee&&!t.paidfee&&(this.familyMembersPaidFee=!1),t.reg_resource=e.reg_resource,t.reg_resource.extension.push({url:"http://ihris.org/fhir/StructureDefinition/registration-status",valueCoding:{system:"http://ihris.org/fhir/CodeSystem/registration-status",code:"pending",display:"Pending"}}),t.family_head_resource={resourceType:"Basic",meta:{profile:["http://ihris.org/fhir/StructureDefinition/itsf-family-head-profile"]},extension:[{url:"http://ihris.org/fhir/StructureDefinition/family-head",valueReference:{reference:"Practitioner/"+this.queries.practitioner}}]},t.fees={resourceType:"Basic",meta:{profile:["http://ihris.org/fhir/StructureDefinition/itsf-school-fees-payment"]},extension:[{url:"http://ihris.org/fhir/StructureDefinition/itsf-payments-amount",valueInteger:0},{url:"http://ihris.org/fhir/StructureDefinition/ihris-practitioner-reference",valueReference:{reference:"Practitioner/"+t.id}}]}}))}))})):this.$store.commit("setMessage",{type:"error",text:"An error has occured, try again later"})}))},getLatestReg(){fetch("/site/student/latestRegistration/"+this.queries.practitioner).then((e=>{e.ok?e.json().then((e=>{this.overlay=!1,this.unit=e.reg_resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/itsf-maahad-unit"===e.url))?.valueCoding,this.stream=e.reg_resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/itsf-maahad-stream"===e.url))?.valueCoding,this.accomodation=e.reg_resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/itsf-acommodation"===e.url))?.valueCoding,this.student_type=e.reg_resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/itsf-student-type"===e.url))?.valueCoding,this.school_fees_type=e.reg_resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/itsf-school-fees-type"===e.url))?.valueReference,this.family_head_category=e.reg_resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/family-head-category"===e.url))?.valueCoding,e.family_head_resource&&(this.family_head=e.family_head_resource.extension.find((e=>"http://ihris.org/fhir/StructureDefinition/family-head"===e.url))?.valueReference),this.registration=e})):(this.overlay=!1,e.json().then((e=>{e.payments&&(this.payments=e.payments),e.controlNumber&&e.controlNumber.data.length&&(this.controlNumber=e.controlNumber.data[0].hijiridate+e.controlNumber.data[0].id),this.$store.commit("setMessage",{type:"error",text:e.message})})))})).catch((()=>{this.overlay=!1,this.$store.commit("setMessage",{type:"error",text:"An error has occured, try later"})}))},save(){this.overlay=!0,this.populateValues(this.$children);let e={resourceType:"Basic",meta:{profile:["http://ihris.org/fhir/StructureDefinition/itsf-school-fees-payment"]},extension:[{url:"http://ihris.org/fhir/StructureDefinition/itsf-payments-amount",valueInteger:0},{url:"http://ihris.org/fhir/StructureDefinition/itsf-payments-date",valueDate:this.$moment().format("YYYY-MM-DD")},{url:"http://ihris.org/fhir/StructureDefinition/ihris-practitioner-reference",valueReference:{reference:"Practitioner/"+this.queries.practitioner}}]},t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/itsf-maahad-unit"===e.url));this.registration.reg_resource.extension[t].valueCoding=this.unit,t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/itsf-maahad-stream"===e.url)),this.registration.reg_resource.extension[t].valueCoding=this.stream,t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/itsf-acommodation"===e.url)),this.registration.reg_resource.extension[t].valueCoding=this.accomodation,t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/itsf-student-type"===e.url)),this.registration.reg_resource.extension[t].valueCoding=this.student_type,t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/itsf-school-fees-type"===e.url)),this.registration.reg_resource.extension[t].valueReference.reference=this.school_fees_type.reference,t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/family-head-category"===e.url)),t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/registration-status"===e.url)),-1==t&&this.registration.reg_resource.extension.push({url:"http://ihris.org/fhir/StructureDefinition/registration-status",valueCoding:{system:"http://ihris.org/fhir/CodeSystem/registration-status",code:"pending",display:"Pending"}}),t=this.registration.reg_resource.extension.findIndex((e=>"http://ihris.org/fhir/StructureDefinition/family-head-category"===e.url)),"Basic/familyfive"==this.school_fees_type.reference||"Basic/familynine"==this.school_fees_type.reference||"Basic/familyinfinity"==this.school_fees_type.reference?-1===t?this.registration.reg_resource.extension.push({url:"http://ihris.org/fhir/StructureDefinition/family-head-category",valueCoding:this.family_head_category}):this.registration.reg_resource.extension[t].valueCoding=this.family_head_category:t>-1&&this.registration.reg_resource.extension.splice(t,1);let i={resource:this.registration.reg_resource,request:{method:"POST",url:"PractitionerRole"}};"new"===this.regStatusCode&&(i.request.method="PUT",i.request.url="PractitionerRole/"+this.registration.reg_resource.id);let r={entry:[i]};if("new"===this.regStatusCode){let e={resourceType:"Basic",meta:{profile:["http://ihris.org/fhir/StructureDefinition/finance-registration-review-profile"]},extension:[{url:"http://ihris.org/fhir/StructureDefinition/ihris-practitioner-reference",valueReference:{reference:"Practitioner/"+this.queries.practitioner}},{url:"http://ihris.org/fhir/StructureDefinition/registration-reference",valueReference:{reference:"PractitionerRole/"+this.registration.reg_resource.id}},{url:"http://ihris.org/fhir/StructureDefinition/registration-status",valueCoding:{system:"http://ihris.org/fhir/CodeSystem/registration-status",code:"pending",display:"Pending"}},{url:"http://ihris.org/fhir/StructureDefinition/start-date",valueDate:this.$moment().format("YYYY-MM-DD")}]},t={resourceType:"Basic",meta:{profile:["http://ihris.org/fhir/StructureDefinition/taalim-registration-review-profile"]},extension:[{url:"http://ihris.org/fhir/StructureDefinition/ihris-practitioner-reference",valueReference:{reference:"Practitioner/"+this.queries.practitioner}},{url:"http://ihris.org/fhir/StructureDefinition/registration-reference",valueReference:{reference:"PractitionerRole/"+this.registration.reg_resource.id}},{url:"http://ihris.org/fhir/StructureDefinition/registration-status",valueCoding:{system:"http://ihris.org/fhir/CodeSystem/registration-status",code:"pending",display:"Pending"}}]};r.entry.push({resource:e,request:{method:"POST",url:"Basic"}}),r.entry.push({resource:t,request:{method:"POST",url:"Basic"}})}if(this.family_head.reference){let e={resourceType:"Basic",meta:{profile:["http://ihris.org/fhir/StructureDefinition/itsf-family-head-profile"]},extension:[{url:"http://ihris.org/fhir/StructureDefinition/family-head",valueReference:{reference:this.family_head.reference}}]};r.entry.push({resource:e,request:{method:"POST",url:"Basic"}})}r.entry.push({resource:e,request:{method:"POST",url:"Basic"}});let s=[r];if(this.members.length)for(let a of this.members){if(!a.reg_resource)continue;let e={memberid:a.id,entry:[{resource:a.reg_resource,request:{method:"POST",url:"PractitionerRole"}},{resource:a.family_head_resource,request:{method:"POST",url:"Basic"}},{resource:a.fees,request:{method:"POST",url:"Basic"}}]};s.push(e)}fetch(`/site/student/renewRegistration?practitioner=${this.queries.practitioner}&fullname=${this.fullname}`,{method:"POST",headers:{"Content-Type":"application/json"},redirect:"manual",body:JSON.stringify(s)}).then((e=>{this.overlay=!1,e.ok?(this.$store.commit("setMessage",{type:"success",text:this.$t("App.hardcoded-texts.Registration Renewed Successfully And Waiting Approval From Registration Office")}),e.json().then((e=>{e.controlNumber&&(this.controlNumber=e.controlNumber),e.controlNumber&&this.$store.commit("setMessage",{type:"success",text:this.$t("App.hardcoded-texts.Please visit any CRDB branch or agent to pay using control number "+e.controlNumber)}),e.message&&this.$store.commit("setMessage",{type:"warning",text:e.message})}))):e.json().then((e=>{let t="Failed to renew registration.";e.message&&(t=e.message),this.$store.commit("setMessage",{type:"error",text:t})})).catch((()=>{this.$store.commit("setMessage",{type:"error",text:this.$t("App.hardcoded-texts.Failed to renew registration")})}))})).catch((()=>{this.$store.commit("setMessage",{type:"error",text:"An error has occured, try later"})}))},getName(){this.$fhirutils.resourceLookup("Practitioner/"+this.queries.practitioner).then((e=>{this.fullname=e}))},populateValues(e){for(let t of e)t.qField&&t.path&&(this[t.path]=t.value),t.$children&&this.populateValues(t.$children)}},created(){this.getName(),this.isMobile&&(this.$store.state.minidrawer=!0),this.overlay=!0,fetch("/site/student/registrationStatus/"+this.queries.practitioner).then((e=>{e.json().then((e=>{this.regStatus=e.status,this.regStatusCode=e.statusCode,"new"===this.regStatusCode&&(this.edit=!0)}))})),this.getLatestReg(),this.getActiveFamilyMembers()}},o=a,n=i(43736),l=i(43453),c=i.n(l),d=i(35098),h=i(63150),u=i(32371),f=i(37118),p=i(95424),m=i(82102),g=i(4228),v=i(40865),y=i(11418),_=i(46232),b=i(96428),C=i(16816),x=i(97620),S=i(65132),w=i(51058),R=i(90624),$=i(62877),P=i(99762),D=i(40314),B=(0,n.Z)(o,r,s,!1,null,null,null),k=B.exports;c()(B,{VAlert:d.Z,VBtn:h.Z,VCard:u.Z,VCardActions:f.h7,VCardText:f.ZB,VCardTitle:f.EB,VChip:p.Z,VCol:m.Z,VContainer:g.Z,VDataTable:v.Z,VDivider:y.Z,VForm:_.Z,VIcon:b.Z,VList:C.Z,VListItem:x.Z,VNavigationDrawer:S.Z,VOverlay:w.Z,VProgressCircular:R.Z,VRow:$.Z,VSpacer:P.Z,VTextField:D.Z})}}]);
//# sourceMappingURL=9135.b4653a5b.js.map