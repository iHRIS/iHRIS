"use strict";(self["webpackChunkiHRIS_v5"]=self["webpackChunkiHRIS_v5"]||[]).push([[2974],{55533:function(t,e,a){a.d(e,{Z:function(){return r}});var s=a(48085),i=a(73325),r=(0,i.Z)(s.Z).extend({name:"v-subheader",props:{inset:Boolean},render(t){return t("div",{staticClass:"v-subheader",class:{"v-subheader--inset":this.inset,...this.themeClasses},attrs:this.$attrs,on:this.$listeners},this.$slots.default)}})},94110:function(t,e,a){a.r(e),a.d(e,{default:function(){return b}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticClass:"py-5"},[a("v-card",[a("v-card-title",[t._v(" Pending New Registration Applications "),a("v-spacer")],1),a("v-card-title",[a("v-select",{staticClass:"ma-2",attrs:{items:t.status,label:"Finance Director Status",outlined:"",dense:"","hide-details":"",clearable:""},on:{change:function(e){return t.buildTerms()},"click:clear":function(e){return t.clearSearch("financestatus")}},model:{value:t.search.financestatus,callback:function(e){t.$set(t.search,"financestatus",e)},expression:"search.financestatus"}}),a("v-select",{staticClass:"ma-2",attrs:{items:t.status,label:"Taalim Director Status",outlined:"",dense:"","hide-details":"",clearable:""},on:{change:function(e){return t.buildTerms()},"click:clear":function(e){return t.clearSearch("taalimstatus")}},model:{value:t.search.taalimstatus,callback:function(e){t.$set(t.search,"taalimstatus",e)},expression:"search.taalimstatus"}}),a("v-text-field",{staticClass:"ma-2",attrs:{label:"Name",dense:"",outlined:"","hide-details":"",clearable:""},on:{change:function(e){return t.buildTerms()},"click:clear":function(e){return t.clearSearch("name")}},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}})],1),t.error_message?a("v-card-subtitle",{staticClass:"white--text error"},[t._v(t._s(t.error_message))]):t._e(),a("v-card-text",[a("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{headers:t.headers,items:t.results,"item-key":"id",options:t.options,"server-items-length":t.total,"footer-props":{"items-per-page-text":t.$t("App.hardcoded-texts.tableText"),"items-per-page-options":[5,10,20,50]},loading:t.loading},on:{"update:options":function(e){t.options=e},"click:row":t.clickIt},scopedSlots:t._u([{key:"item.financeStatus",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.getColor(s.financeStatus),dark:""}},[t._v(" "+t._s(s.financeStatus)+" ")])]}},{key:"item.taalimStatus",fn:function(e){var s=e.item;return[a("v-chip",{attrs:{color:t.getColor(s.taalimStatus),dark:""}},[t._v(" "+t._s(s.taalimStatus)+" ")])]}}])})],1)],1)],1)},i=[],r={data:function(){return{search:{name:"",taalimstatus:"",financestatus:""},debug:"",terms:{},headers:[{text:"Name",value:"name"},{text:"Date of Birth",value:"birthDate"},{text:"Gender",value:"gender"},{text:"Nationality",value:"nationality"},{text:"Phone",value:"phone"},{text:"Finance Director",value:"financeStatus"},{text:"Taalim Director",value:"taalimStatus"}],status:[{text:"Pending",value:"pending"},{text:"Approved",value:"approved"},{text:"Reject",value:"reject"}],results:[],options:{itemsPerPage:10},loading:!1,total:0,prevPage:-1,link:[],error_message:null,update_again:{rerun:!1,restart:!1}}},watch:{options:{handler(){this.getData()},deep:!0}},mounted:function(){this.getData(!0)},methods:{clearSearch:function(t){this.search[t]="",this.buildTerms()},clickIt:function(t){this.$router.push("/custom/new_registration_view?path=/itsf&id="+t.id)},checkRerun(){!this.loading&&this.update_again.rerun&&(this.getData(this.update_again.restart),this.update_again={rerun:!1,restart:!1})},async buildTerms(){this.terms={},this.search.name&&(this.terms["name"]=this.search.name),this.search.financestatus&&(this.terms["newappfinancestatus"]=this.search.financestatus),this.search.taalimstatus&&(this.terms["newapptaalimstatus"]=this.search.taalimstatus),this.getData(!0)},getColor(t){return"Pending"===t?"warning":"Rejected"===t?"error":"Approved"===t?"success":"grey"},getData(t){if(this.loading)return this.update_again.rerun=!0,void(this.update_again.restart=this.update_again.restart||t);this.loading=!0,this.error_message=null;let e="",a=this.options.itemsPerPage||10;if(t&&(this.options.page=1),this.options.page>1&&(this.options.page===this.prevPage-1?e=this.link.find((t=>"previous"===t.relation)).url:this.options.page===this.prevPage+1&&(e=this.link.find((t=>"next"===t.relation)).url),e=e.replace("/fhir?","/site/student/getRegistrationApplications?"),e=e.substring(e.indexOf("/site/student/getRegistrationApplications")),-1===e.indexOf("_sort=-_lastUpdated")&&(e+="&_sort=-_lastUpdated"),-1===e.indexOf("_total=accurate")&&(e+="&_total=accurate")),""===e){let t="";for(let e in this.options.sortBy)t&&(t+=","),this.options.sortDesc[e]&&(t+="-"),t+=this.options.sortBy[e];e="/site/student/getRegistrationApplications?_count="+a+"&_profile=http://ihris.org/fhir/StructureDefinition/itsf-registration-application&_sort=-_lastUpdated&_total=accurate",this.debug=e}let s=Object.keys(this.terms);for(let i of s)Array.isArray(this.terms[i])?this.terms[i].length>0&&(e+="&"+i+"="+this.terms[i].join(",")):this.terms[i]&&(e+="&"+i+"="+this.terms[i]);this.prevPage=this.options.page,console.log("fetching",e),fetch(e).then((t=>{t.json().then((async t=>{this.results=[],t.total>0&&(this.link=t.link,this.results=t.data),this.total=t.total,this.loading=!1,this.checkRerun()})).catch((t=>{this.loading=!1,this.error_message="Unable to load results.",this.checkRerun(),console.log(t)}))})).catch((t=>{this.loading=!1,this.error_message="Unable to load results.",this.checkRerun(),console.log(t)}))}}},n=r,l=a(43736),o=a(43453),c=a.n(o),u=a(32371),h=a(37118),d=a(95424),p=a(4228),g=a(40865),m=a(43986),f=a(99762),v=a(40314),_=(0,l.Z)(n,s,i,!1,null,null,null),b=_.exports;c()(_,{VCard:u.Z,VCardSubtitle:h.Qq,VCardText:h.ZB,VCardTitle:h.EB,VChip:d.Z,VContainer:p.Z,VDataTable:g.Z,VSelect:m.Z,VSpacer:f.Z,VTextField:v.Z})}}]);
//# sourceMappingURL=2974.013dc107.js.map